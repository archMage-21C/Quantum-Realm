/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var jt=Object.create;var Ke=Object.defineProperty;var Yt=Object.getOwnPropertyDescriptor;var Gt=Object.getOwnPropertyNames;var Jt=Object.getPrototypeOf,Xt=Object.prototype.hasOwnProperty;var Qt=(c,a)=>()=>(c&&(a=c(c=0)),a);var Zt=(c,a)=>()=>(a||c((a={exports:{}}).exports,a),a.exports),ei=(c,a)=>{for(var t in a)Ke(c,t,{get:a[t],enumerable:!0})},_t=(c,a,t,e)=>{if(a&&typeof a=="object"||typeof a=="function")for(let i of Gt(a))!Xt.call(c,i)&&i!==t&&Ke(c,i,{get:()=>a[i],enumerable:!(e=Yt(a,i))||e.enumerable});return c};var ti=(c,a,t)=>(t=c!=null?jt(Jt(c)):{},_t(a||!c||!c.__esModule?Ke(t,"default",{value:c,enumerable:!0}):t,c)),ii=c=>_t(Ke({},"__esModule",{value:!0}),c);function bt(c){var a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;c=c.replace(a,function(e,i,s,r){return i+i+s+s+r+r});var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null}function ri(c,a,t){return Math.min(Math.max(c,a),t)}function we(c,a){return a.indexOf(c)>-1}var si,v=Qt(()=>{si=function(c,a){var t=document.querySelector("#"+c+" > .particles-js-canvas-el");this.pJS={canvas:{el:t,w:t.offsetWidth,h:t.offsetHeight},particles:{number:{value:400,density:{enable:!0,value_area:800}},color:{value:"#fff"},shape:{type:"circle",stroke:{width:0,color:"#ff0000"},polygon:{nb_sides:5},image:{src:"",width:100,height:100}},opacity:{value:1,random:!1,anim:{enable:!1,speed:2,opacity_min:0,sync:!1}},size:{value:20,random:!1,anim:{enable:!1,speed:20,size_min:0,sync:!1}},line_linked:{enable:!0,distance:100,color:"#fff",opacity:1,width:1},move:{enable:!0,speed:2,direction:"none",random:!1,straight:!1,out_mode:"out",bounce:!1,attract:{enable:!1,rotateX:3e3,rotateY:3e3}},array:[]},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"grab"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:100,line_linked:{opacity:1}},bubble:{distance:200,size:80,duration:.4},repulse:{distance:200,duration:.4},push:{particles_nb:4},remove:{particles_nb:2}},mouse:{}},retina_detect:!1,fn:{interact:{},modes:{},vendors:{}},tmp:{}};var e=this.pJS;a&&Object.deepExtend(e,a),e.tmp.obj={size_value:e.particles.size.value,size_anim_speed:e.particles.size.anim.speed,move_speed:e.particles.move.speed,line_linked_distance:e.particles.line_linked.distance,line_linked_width:e.particles.line_linked.width,mode_grab_distance:e.interactivity.modes.grab.distance,mode_bubble_distance:e.interactivity.modes.bubble.distance,mode_bubble_size:e.interactivity.modes.bubble.size,mode_repulse_distance:e.interactivity.modes.repulse.distance},e.fn.retinaInit=function(){e.retina_detect&&window.devicePixelRatio>1?(e.canvas.pxratio=window.devicePixelRatio,e.tmp.retina=!0):(e.canvas.pxratio=1,e.tmp.retina=!1),e.canvas.w=e.canvas.el.offsetWidth*e.canvas.pxratio,e.canvas.h=e.canvas.el.offsetHeight*e.canvas.pxratio,e.particles.size.value=e.tmp.obj.size_value*e.canvas.pxratio,e.particles.size.anim.speed=e.tmp.obj.size_anim_speed*e.canvas.pxratio,e.particles.move.speed=e.tmp.obj.move_speed*e.canvas.pxratio,e.particles.line_linked.distance=e.tmp.obj.line_linked_distance*e.canvas.pxratio,e.interactivity.modes.grab.distance=e.tmp.obj.mode_grab_distance*e.canvas.pxratio,e.interactivity.modes.bubble.distance=e.tmp.obj.mode_bubble_distance*e.canvas.pxratio,e.particles.line_linked.width=e.tmp.obj.line_linked_width*e.canvas.pxratio,e.interactivity.modes.bubble.size=e.tmp.obj.mode_bubble_size*e.canvas.pxratio,e.interactivity.modes.repulse.distance=e.tmp.obj.mode_repulse_distance*e.canvas.pxratio},e.fn.canvasInit=function(){e.canvas.ctx=e.canvas.el.getContext("2d")},e.fn.canvasSize=function(){e.canvas.el.width=e.canvas.w,e.canvas.el.height=e.canvas.h,e&&e.interactivity.events.resize&&window.addEventListener("resize",function(){e.canvas.w=e.canvas.el.offsetWidth,e.canvas.h=e.canvas.el.offsetHeight,e.tmp.retina&&(e.canvas.w*=e.canvas.pxratio,e.canvas.h*=e.canvas.pxratio),e.canvas.el.width=e.canvas.w,e.canvas.el.height=e.canvas.h,e.particles.move.enable||(e.fn.particlesEmpty(),e.fn.particlesCreate(),e.fn.particlesDraw(),e.fn.vendors.densityAutoParticles()),e.fn.vendors.densityAutoParticles()})},e.fn.canvasPaint=function(){e.canvas.ctx.fillRect(0,0,e.canvas.w,e.canvas.h)},e.fn.canvasClear=function(){e.canvas.ctx.clearRect(0,0,e.canvas.w,e.canvas.h)},e.fn.particle=function(i,s,r){if(this.radius=(e.particles.size.random?Math.random():1)*e.particles.size.value,e.particles.size.anim.enable&&(this.size_status=!1,this.vs=e.particles.size.anim.speed/100,e.particles.size.anim.sync||(this.vs=this.vs*Math.random())),this.x=r?r.x:Math.random()*e.canvas.w,this.y=r?r.y:Math.random()*e.canvas.h,this.x>e.canvas.w-this.radius*2?this.x=this.x-this.radius:this.x<this.radius*2&&(this.x=this.x+this.radius),this.y>e.canvas.h-this.radius*2?this.y=this.y-this.radius:this.y<this.radius*2&&(this.y=this.y+this.radius),e.particles.move.bounce&&e.fn.vendors.checkOverlap(this,r),this.color={},typeof i.value=="object")if(i.value instanceof Array){var n=i.value[Math.floor(Math.random()*e.particles.color.value.length)];this.color.rgb=bt(n)}else i.value.r!=null&&i.value.g!=null&&i.value.b!=null&&(this.color.rgb={r:i.value.r,g:i.value.g,b:i.value.b}),i.value.h!=null&&i.value.s!=null&&i.value.l!=null&&(this.color.hsl={h:i.value.h,s:i.value.s,l:i.value.l});else i.value=="random"?this.color.rgb={r:Math.floor(Math.random()*256)+0,g:Math.floor(Math.random()*256)+0,b:Math.floor(Math.random()*256)+0}:typeof i.value=="string"&&(this.color=i,this.color.rgb=bt(this.color.value));this.opacity=(e.particles.opacity.random?Math.random():1)*e.particles.opacity.value,e.particles.opacity.anim.enable&&(this.opacity_status=!1,this.vo=e.particles.opacity.anim.speed/100,e.particles.opacity.anim.sync||(this.vo=this.vo*Math.random()));var o={};switch(e.particles.move.direction){case"top":o={x:0,y:-1};break;case"top-right":o={x:.5,y:-.5};break;case"right":o={x:1,y:-0};break;case"bottom-right":o={x:.5,y:.5};break;case"bottom":o={x:0,y:1};break;case"bottom-left":o={x:-.5,y:1};break;case"left":o={x:-1,y:0};break;case"top-left":o={x:-.5,y:-.5};break;default:o={x:0,y:0};break}e.particles.move.straight?(this.vx=o.x,this.vy=o.y,e.particles.move.random&&(this.vx=this.vx*Math.random(),this.vy=this.vy*Math.random())):(this.vx=o.x+Math.random()-.5,this.vy=o.y+Math.random()-.5),this.vx_i=this.vx,this.vy_i=this.vy;var l=e.particles.shape.type;if(typeof l=="object"){if(l instanceof Array){var p=l[Math.floor(Math.random()*l.length)];this.shape=p}}else this.shape=l;if(this.shape=="image"){var m=e.particles.shape;this.img={src:m.image.src,ratio:m.image.width/m.image.height},this.img.ratio||(this.img.ratio=1),e.tmp.img_type=="svg"&&e.tmp.source_svg!=null&&(e.fn.vendors.createSvgImg(this),e.tmp.pushing&&(this.img.loaded=!1))}},e.fn.particle.prototype.draw=function(){var i=this;if(i.radius_bubble!=null)var s=i.radius_bubble;else var s=i.radius;if(i.opacity_bubble!=null)var r=i.opacity_bubble;else var r=i.opacity;if(i.color.rgb)var n="rgba("+i.color.rgb.r+","+i.color.rgb.g+","+i.color.rgb.b+","+r+")";else var n="hsla("+i.color.hsl.h+","+i.color.hsl.s+"%,"+i.color.hsl.l+"%,"+r+")";switch(e.canvas.ctx.fillStyle=n,e.canvas.ctx.beginPath(),i.shape){case"circle":e.canvas.ctx.arc(i.x,i.y,s,0,Math.PI*2,!1);break;case"edge":e.canvas.ctx.rect(i.x-s,i.y-s,s*2,s*2);break;case"triangle":e.fn.vendors.drawShape(e.canvas.ctx,i.x-s,i.y+s/1.66,s*2,3,2);break;case"polygon":e.fn.vendors.drawShape(e.canvas.ctx,i.x-s/(e.particles.shape.polygon.nb_sides/3.5),i.y-s/.76,s*2.66/(e.particles.shape.polygon.nb_sides/3),e.particles.shape.polygon.nb_sides,1);break;case"star":e.fn.vendors.drawShape(e.canvas.ctx,i.x-s*2/(e.particles.shape.polygon.nb_sides/4),i.y-s/1.52,s*2*2.66/(e.particles.shape.polygon.nb_sides/3),e.particles.shape.polygon.nb_sides,2);break;case"image":let p=function(){e.canvas.ctx.drawImage(o,i.x-s,i.y-s,s*2,s*2/i.img.ratio)};var l=p;if(e.tmp.img_type=="svg")var o=i.img.obj;else var o=e.tmp.img_obj;o&&p();break}e.canvas.ctx.closePath(),e.particles.shape.stroke.width>0&&(e.canvas.ctx.strokeStyle=e.particles.shape.stroke.color,e.canvas.ctx.lineWidth=e.particles.shape.stroke.width,e.canvas.ctx.stroke()),e.canvas.ctx.fill()},e.fn.particlesCreate=function(){for(var i=0;i<e.particles.number.value;i++)e.particles.array.push(new e.fn.particle(e.particles.color,e.particles.opacity.value))},e.fn.particlesUpdate=function(){for(var i=0;i<e.particles.array.length;i++){var s=e.particles.array[i];if(e.particles.move.enable){var r=e.particles.move.speed/2;s.x+=s.vx*r,s.y+=s.vy*r}if(e.particles.opacity.anim.enable&&(s.opacity_status==!0?(s.opacity>=e.particles.opacity.value&&(s.opacity_status=!1),s.opacity+=s.vo):(s.opacity<=e.particles.opacity.anim.opacity_min&&(s.opacity_status=!0),s.opacity-=s.vo),s.opacity<0&&(s.opacity=0)),e.particles.size.anim.enable&&(s.size_status==!0?(s.radius>=e.particles.size.value&&(s.size_status=!1),s.radius+=s.vs):(s.radius<=e.particles.size.anim.size_min&&(s.size_status=!0),s.radius-=s.vs),s.radius<0&&(s.radius=0)),e.particles.move.out_mode=="bounce")var n={x_left:s.radius,x_right:e.canvas.w,y_top:s.radius,y_bottom:e.canvas.h};else var n={x_left:-s.radius,x_right:e.canvas.w+s.radius,y_top:-s.radius,y_bottom:e.canvas.h+s.radius};switch(s.x-s.radius>e.canvas.w?(s.x=n.x_left,s.y=Math.random()*e.canvas.h):s.x+s.radius<0&&(s.x=n.x_right,s.y=Math.random()*e.canvas.h),s.y-s.radius>e.canvas.h?(s.y=n.y_top,s.x=Math.random()*e.canvas.w):s.y+s.radius<0&&(s.y=n.y_bottom,s.x=Math.random()*e.canvas.w),e.particles.move.out_mode){case"bounce":(s.x+s.radius>e.canvas.w||s.x-s.radius<0)&&(s.vx=-s.vx),(s.y+s.radius>e.canvas.h||s.y-s.radius<0)&&(s.vy=-s.vy);break}if(we("grab",e.interactivity.events.onhover.mode)&&e.fn.modes.grabParticle(s),(we("bubble",e.interactivity.events.onhover.mode)||we("bubble",e.interactivity.events.onclick.mode))&&e.fn.modes.bubbleParticle(s),(we("repulse",e.interactivity.events.onhover.mode)||we("repulse",e.interactivity.events.onclick.mode))&&e.fn.modes.repulseParticle(s),e.particles.line_linked.enable||e.particles.move.attract.enable)for(var o=i+1;o<e.particles.array.length;o++){var l=e.particles.array[o];e.particles.line_linked.enable&&e.fn.interact.linkParticles(s,l),e.particles.move.attract.enable&&e.fn.interact.attractParticles(s,l),e.particles.move.bounce&&e.fn.interact.bounceParticles(s,l)}}},e.fn.particlesDraw=function(){e.canvas.ctx.clearRect(0,0,e.canvas.w,e.canvas.h),e.fn.particlesUpdate();for(var i=0;i<e.particles.array.length;i++){var s=e.particles.array[i];s.draw()}},e.fn.particlesEmpty=function(){e.particles.array=[]},e.fn.particlesRefresh=function(){cancelRequestAnimFrame(e.fn.checkAnimFrame),cancelRequestAnimFrame(e.fn.drawAnimFrame),e.tmp.source_svg=void 0,e.tmp.img_obj=void 0,e.tmp.count_svg=0,e.fn.particlesEmpty(),e.fn.canvasClear(),e.fn.vendors.start()},e.fn.interact.linkParticles=function(i,s){var r=i.x-s.x,n=i.y-s.y,o=Math.sqrt(r*r+n*n);if(o<=e.particles.line_linked.distance){var l=e.particles.line_linked.opacity-o/(1/e.particles.line_linked.opacity)/e.particles.line_linked.distance;if(l>0){var p=e.particles.line_linked.color_rgb_line;e.canvas.ctx.strokeStyle="rgba("+p.r+","+p.g+","+p.b+","+l+")",e.canvas.ctx.lineWidth=e.particles.line_linked.width,e.canvas.ctx.beginPath(),e.canvas.ctx.moveTo(i.x,i.y),e.canvas.ctx.lineTo(s.x,s.y),e.canvas.ctx.stroke(),e.canvas.ctx.closePath()}}},e.fn.interact.attractParticles=function(i,s){var r=i.x-s.x,n=i.y-s.y,o=Math.sqrt(r*r+n*n);if(o<=e.particles.line_linked.distance){var l=r/(e.particles.move.attract.rotateX*1e3),p=n/(e.particles.move.attract.rotateY*1e3);i.vx-=l,i.vy-=p,s.vx+=l,s.vy+=p}},e.fn.interact.bounceParticles=function(i,s){var r=i.x-s.x,n=i.y-s.y,o=Math.sqrt(r*r+n*n),l=i.radius+s.radius;o<=l&&(i.vx=-i.vx,i.vy=-i.vy,s.vx=-s.vx,s.vy=-s.vy)},e.fn.modes.pushParticles=function(i,s){e.tmp.pushing=!0;for(var r=0;r<i;r++)e.particles.array.push(new e.fn.particle(e.particles.color,e.particles.opacity.value,{x:s?s.pos_x:Math.random()*e.canvas.w,y:s?s.pos_y:Math.random()*e.canvas.h})),r==i-1&&(e.particles.move.enable||e.fn.particlesDraw(),e.tmp.pushing=!1)},e.fn.modes.removeParticles=function(i){e.particles.array.splice(0,i),e.particles.move.enable||e.fn.particlesDraw()},e.fn.modes.bubbleParticle=function(i){if(e.interactivity.events.onhover.enable&&we("bubble",e.interactivity.events.onhover.mode)){let k=function(){i.opacity_bubble=i.opacity,i.radius_bubble=i.radius};var S=k,s=i.x-e.interactivity.mouse.pos_x,r=i.y-e.interactivity.mouse.pos_y,n=Math.sqrt(s*s+r*r),o=1-n/e.interactivity.modes.bubble.distance;if(n<=e.interactivity.modes.bubble.distance){if(o>=0&&e.interactivity.status=="mousemove"){if(e.interactivity.modes.bubble.size!=e.particles.size.value)if(e.interactivity.modes.bubble.size>e.particles.size.value){var l=i.radius+e.interactivity.modes.bubble.size*o;l>=0&&(i.radius_bubble=l)}else{var p=i.radius-e.interactivity.modes.bubble.size,l=i.radius-p*o;l>0?i.radius_bubble=l:i.radius_bubble=0}if(e.interactivity.modes.bubble.opacity!=e.particles.opacity.value)if(e.interactivity.modes.bubble.opacity>e.particles.opacity.value){var m=e.interactivity.modes.bubble.opacity*o;m>i.opacity&&m<=e.interactivity.modes.bubble.opacity&&(i.opacity_bubble=m)}else{var m=i.opacity-(e.particles.opacity.value-e.interactivity.modes.bubble.opacity)*o;m<i.opacity&&m>=e.interactivity.modes.bubble.opacity&&(i.opacity_bubble=m)}}}else k();e.interactivity.status=="mouseleave"&&k()}else if(e.interactivity.events.onclick.enable&&we("bubble",e.interactivity.events.onclick.mode)){let k=function(F,V,ie,O,H){if(F!=V)if(e.tmp.bubble_duration_end){if(ie!=null){var j=O-w*(O-F)/e.interactivity.modes.bubble.duration,z=F-j;L=F+z,H=="size"&&(i.radius_bubble=L),H=="opacity"&&(i.opacity_bubble=L)}}else if(n<=e.interactivity.modes.bubble.distance){if(ie!=null)var X=ie;else var X=O;if(X!=F){var L=O-w*(O-F)/e.interactivity.modes.bubble.duration;H=="size"&&(i.radius_bubble=L),H=="opacity"&&(i.opacity_bubble=L)}}else H=="size"&&(i.radius_bubble=void 0),H=="opacity"&&(i.opacity_bubble=void 0)};var T=k;if(e.tmp.bubble_clicking){var s=i.x-e.interactivity.mouse.click_pos_x,r=i.y-e.interactivity.mouse.click_pos_y,n=Math.sqrt(s*s+r*r),w=(new Date().getTime()-e.interactivity.mouse.click_time)/1e3;w>e.interactivity.modes.bubble.duration&&(e.tmp.bubble_duration_end=!0),w>e.interactivity.modes.bubble.duration*2&&(e.tmp.bubble_clicking=!1,e.tmp.bubble_duration_end=!1)}e.tmp.bubble_clicking&&(k(e.interactivity.modes.bubble.size,e.particles.size.value,i.radius_bubble,i.radius,"size"),k(e.interactivity.modes.bubble.opacity,e.particles.opacity.value,i.opacity_bubble,i.opacity,"opacity"))}},e.fn.modes.repulseParticle=function(i){if(e.interactivity.events.onhover.enable&&we("repulse",e.interactivity.events.onhover.mode)&&e.interactivity.status=="mousemove"){var s=i.x-e.interactivity.mouse.pos_x,r=i.y-e.interactivity.mouse.pos_y,n=Math.sqrt(s*s+r*r),o={x:s/n,y:r/n},l=e.interactivity.modes.repulse.distance,p=100,m=ri(1/l*(-1*Math.pow(n/l,2)+1)*l*p,0,50),w={x:i.x+o.x*m,y:i.y+o.y*m};e.particles.move.out_mode=="bounce"?(w.x-i.radius>0&&w.x+i.radius<e.canvas.w&&(i.x=w.x),w.y-i.radius>0&&w.y+i.radius<e.canvas.h&&(i.y=w.y)):(i.x=w.x,i.y=w.y)}else if(e.interactivity.events.onclick.enable&&we("repulse",e.interactivity.events.onclick.mode))if(e.tmp.repulse_finish||(e.tmp.repulse_count++,e.tmp.repulse_count==e.particles.array.length&&(e.tmp.repulse_finish=!0)),e.tmp.repulse_clicking){let O=function(){var H=Math.atan2(T,S);if(i.vx=F*Math.cos(H),i.vy=F*Math.sin(H),e.particles.move.out_mode=="bounce"){var X={x:i.x+i.vx,y:i.y+i.vy};(X.x+i.radius>e.canvas.w||X.x-i.radius<0)&&(i.vx=-i.vx),(X.y+i.radius>e.canvas.h||X.y-i.radius<0)&&(i.vy=-i.vy)}};var V=O,l=Math.pow(e.interactivity.modes.repulse.distance/6,3),S=e.interactivity.mouse.click_pos_x-i.x,T=e.interactivity.mouse.click_pos_y-i.y,k=S*S+T*T,F=-l/k*1;k<=l&&O()}else e.tmp.repulse_clicking==!1&&(i.vx=i.vx_i,i.vy=i.vy_i)},e.fn.modes.grabParticle=function(i){if(e.interactivity.events.onhover.enable&&e.interactivity.status=="mousemove"){var s=i.x-e.interactivity.mouse.pos_x,r=i.y-e.interactivity.mouse.pos_y,n=Math.sqrt(s*s+r*r);if(n<=e.interactivity.modes.grab.distance){var o=e.interactivity.modes.grab.line_linked.opacity-n/(1/e.interactivity.modes.grab.line_linked.opacity)/e.interactivity.modes.grab.distance;if(o>0){var l=e.particles.line_linked.color_rgb_line;e.canvas.ctx.strokeStyle="rgba("+l.r+","+l.g+","+l.b+","+o+")",e.canvas.ctx.lineWidth=e.particles.line_linked.width,e.canvas.ctx.beginPath(),e.canvas.ctx.moveTo(i.x,i.y),e.canvas.ctx.lineTo(e.interactivity.mouse.pos_x,e.interactivity.mouse.pos_y),e.canvas.ctx.stroke(),e.canvas.ctx.closePath()}}}},e.fn.vendors.eventsListeners=function(){e.interactivity.detect_on=="window"?e.interactivity.el=window:e.interactivity.el=e.canvas.el,(e.interactivity.events.onhover.enable||e.interactivity.events.onclick.enable)&&(e.interactivity.el.addEventListener("mousemove",function(i){if(e.interactivity.el==window)var s=i.clientX,r=i.clientY;else var s=i.offsetX||i.clientX,r=i.offsetY||i.clientY;e.interactivity.mouse.pos_x=s,e.interactivity.mouse.pos_y=r,e.tmp.retina&&(e.interactivity.mouse.pos_x*=e.canvas.pxratio,e.interactivity.mouse.pos_y*=e.canvas.pxratio),e.interactivity.status="mousemove"}),e.interactivity.el.addEventListener("mouseleave",function(i){e.interactivity.mouse.pos_x=null,e.interactivity.mouse.pos_y=null,e.interactivity.status="mouseleave"})),e.interactivity.events.onclick.enable&&e.interactivity.el.addEventListener("click",function(){if(e.interactivity.mouse.click_pos_x=e.interactivity.mouse.pos_x,e.interactivity.mouse.click_pos_y=e.interactivity.mouse.pos_y,e.interactivity.mouse.click_time=new Date().getTime(),e.interactivity.events.onclick.enable)switch(e.interactivity.events.onclick.mode){case"push":e.particles.move.enable||e.interactivity.modes.push.particles_nb==1?e.fn.modes.pushParticles(e.interactivity.modes.push.particles_nb,e.interactivity.mouse):e.interactivity.modes.push.particles_nb>1&&e.fn.modes.pushParticles(e.interactivity.modes.push.particles_nb);break;case"remove":e.fn.modes.removeParticles(e.interactivity.modes.remove.particles_nb);break;case"bubble":e.tmp.bubble_clicking=!0;break;case"repulse":e.tmp.repulse_clicking=!0,e.tmp.repulse_count=0,e.tmp.repulse_finish=!1,setTimeout(function(){e.tmp.repulse_clicking=!1},e.interactivity.modes.repulse.duration*1e3);break}})},e.fn.vendors.densityAutoParticles=function(){if(e.particles.number.density.enable){var i=e.canvas.el.width*e.canvas.el.height/1e3;e.tmp.retina&&(i=i/(e.canvas.pxratio*2));var s=i*e.particles.number.value/e.particles.number.density.value_area,r=e.particles.array.length-s;r<0?e.fn.modes.pushParticles(Math.abs(r)):e.fn.modes.removeParticles(r)}},e.fn.vendors.checkOverlap=function(i,s){for(var r=0;r<e.particles.array.length;r++){var n=e.particles.array[r],o=i.x-n.x,l=i.y-n.y,p=Math.sqrt(o*o+l*l);p<=i.radius+n.radius&&(i.x=s?s.x:Math.random()*e.canvas.w,i.y=s?s.y:Math.random()*e.canvas.h,e.fn.vendors.checkOverlap(i))}},e.fn.vendors.createSvgImg=function(i){var s=e.tmp.source_svg,r=/#([0-9A-F]{3,6})/gi,n=s.replace(r,function(w,S,T,k){if(i.color.rgb)var F="rgba("+i.color.rgb.r+","+i.color.rgb.g+","+i.color.rgb.b+","+i.opacity+")";else var F="hsla("+i.color.hsl.h+","+i.color.hsl.s+"%,"+i.color.hsl.l+"%,"+i.opacity+")";return F}),o=new Blob([n],{type:"image/svg+xml;charset=utf-8"}),l=window.URL||window.webkitURL||window,p=l.createObjectURL(o),m=new Image;m.addEventListener("load",function(){i.img.obj=m,i.img.loaded=!0,l.revokeObjectURL(p),e.tmp.count_svg++}),m.src=p},e.fn.vendors.destroypJS=function(){cancelAnimationFrame(e.fn.drawAnimFrame),t.remove(),pJSDom=null},e.fn.vendors.drawShape=function(i,s,r,n,o,l){var p=o*l,m=o/l,w=180*(m-2)/m,S=Math.PI-Math.PI*w/180;i.save(),i.beginPath(),i.translate(s,r),i.moveTo(0,0);for(var T=0;T<p;T++)i.lineTo(n,0),i.translate(n,0),i.rotate(S);i.fill(),i.restore()},e.fn.vendors.exportImg=function(){window.open(e.canvas.el.toDataURL("image/png"),"_blank")},e.fn.vendors.loadImg=function(i){if(e.tmp.img_error=void 0,e.particles.shape.image.src!="")if(i=="svg"){var s=new XMLHttpRequest;s.open("GET",e.particles.shape.image.src),s.onreadystatechange=function(n){s.readyState==4&&(s.status==200?(e.tmp.source_svg=n.currentTarget.response,e.fn.vendors.checkBeforeDraw()):(console.log("Error pJS - Image not found"),e.tmp.img_error=!0))},s.send()}else{var r=new Image;r.addEventListener("load",function(){e.tmp.img_obj=r,e.fn.vendors.checkBeforeDraw()}),r.src=e.particles.shape.image.src}else console.log("Error pJS - No image.src"),e.tmp.img_error=!0},e.fn.vendors.draw=function(){e.particles.shape.type=="image"?e.tmp.img_type=="svg"?e.tmp.count_svg>=e.particles.number.value?(e.fn.particlesDraw(),e.particles.move.enable?e.fn.drawAnimFrame=requestAnimFrame(e.fn.vendors.draw):cancelRequestAnimFrame(e.fn.drawAnimFrame)):e.tmp.img_error||(e.fn.drawAnimFrame=requestAnimFrame(e.fn.vendors.draw)):e.tmp.img_obj!=null?(e.fn.particlesDraw(),e.particles.move.enable?e.fn.drawAnimFrame=requestAnimFrame(e.fn.vendors.draw):cancelRequestAnimFrame(e.fn.drawAnimFrame)):e.tmp.img_error||(e.fn.drawAnimFrame=requestAnimFrame(e.fn.vendors.draw)):(e.fn.particlesDraw(),e.particles.move.enable?e.fn.drawAnimFrame=requestAnimFrame(e.fn.vendors.draw):cancelRequestAnimFrame(e.fn.drawAnimFrame))},e.fn.vendors.checkBeforeDraw=function(){e.particles.shape.type=="image"?e.tmp.img_type=="svg"&&e.tmp.source_svg==null?e.tmp.checkAnimFrame=requestAnimFrame(check):(cancelRequestAnimFrame(e.tmp.checkAnimFrame),e.tmp.img_error||(e.fn.vendors.init(),e.fn.vendors.draw())):(e.fn.vendors.init(),e.fn.vendors.draw())},e.fn.vendors.init=function(){e.fn.retinaInit(),e.fn.canvasInit(),e.fn.canvasSize(),e.fn.canvasPaint(),e.fn.particlesCreate(),e.fn.vendors.densityAutoParticles(),e.particles.line_linked.color_rgb_line=bt(e.particles.line_linked.color)},e.fn.vendors.start=function(){we("image",e.particles.shape.type)?(e.tmp.img_type=e.particles.shape.image.src.substr(e.particles.shape.image.src.length-3),e.fn.vendors.loadImg(e.tmp.img_type)):e.fn.vendors.checkBeforeDraw()},e.fn.vendors.eventsListeners(),e.fn.vendors.start()};Object.deepExtend=function(c,a){for(var t in a)a[t]&&a[t].constructor&&a[t].constructor===Object?(c[t]=c[t]||{},arguments.callee(c[t],a[t])):c[t]=a[t];return c};window.requestAnimFrame=function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(c){window.setTimeout(c,1e3/60)}}();window.cancelRequestAnimFrame=function(){return window.cancelAnimationFrame||window.webkitCancelRequestAnimationFrame||window.mozCancelRequestAnimationFrame||window.oCancelRequestAnimationFrame||window.msCancelRequestAnimationFrame||clearTimeout}();window.pJSDom=[];window.particlesJS=function(c,a){typeof c!="string"&&(a=c,c="particles-js"),c||(c="particles-js");var t=document.getElementById(c),e="particles-js-canvas-el",i=t.getElementsByClassName(e);if(i.length)for(;i.length>0;)t.removeChild(i[0]);var s=document.createElement("canvas");s.className=e,s.style.width="100%",s.style.height="100%";var r=document.getElementById(c).appendChild(s);r!=null&&pJSDom.push(new si(c,a))};window.particlesJS.load=function(c,a,t){var e=new XMLHttpRequest;e.open("GET",a),e.onreadystatechange=function(i){if(e.readyState==4)if(e.status==200){var s=JSON.parse(i.currentTarget.response);window.particlesJS(c,s),t&&t()}else console.log("Error pJS - XMLHttpRequest status: "+e.status),console.log("Error pJS - File config not found")},e.send()}});var It=Zt((Lt,We)=>{v();((c,a)=>{typeof define=="function"&&define.amd?define([],a):typeof We=="object"&&We.exports?We.exports=a():c.fuzzysort=a()})(Lt,c=>{"use strict";var a=(h,d)=>{if(!h||!d)return A;var g=S(h);xe(d)||(d=w(d));var b=g.bitflags;return(b&d._bitflags)!==b?A:k(g,d)},t=(h,d,g)=>{if(!h)return g!=null&&g.all?T(d,g):ze;var b=S(h),P=b.bitflags,y=b.containsSpace,f=p((g==null?void 0:g.threshold)||0),x=(g==null?void 0:g.limit)||Ue,E=0,C=0,I=d.length;function le(Le){E<x?(_e.add(Le),++E):(++C,Le._score>_e.peek()._score&&_e.replaceTop(Le))}if(g!=null&&g.key)for(var ee=g.key,N=0;N<I;++N){var re=d[N],D=Ee(re,ee);if(D&&(xe(D)||(D=w(D)),(P&D._bitflags)===P)){var B=k(b,D);B!==A&&(B._score<f||(B.obj=re,le(B)))}}else if(g!=null&&g.keys){var Ae=g.keys,me=Ae.length;e:for(var N=0;N<I;++N){var re=d[N];{for(var te=0,R=0;R<me;++R){var ee=Ae[R],D=Ee(re,ee);if(!D){ue[R]=K;continue}xe(D)||(D=w(D)),ue[R]=D,te|=D._bitflags}if((P&te)!==P)continue}if(y)for(let q=0;q<b.spaceSearches.length;q++)Y[q]=ae;for(var R=0;R<me;++R){if(D=ue[R],D===K){se[R]=K;continue}if(se[R]=k(b,D,!1,y),se[R]===A){se[R]=K;continue}if(y)for(let U=0;U<b.spaceSearches.length;U++){if(Z[U]>-1e3&&Y[U]>ae){var Q=(Y[U]+Z[U])/4;Q>Y[U]&&(Y[U]=Q)}Z[U]>Y[U]&&(Y[U]=Z[U])}}if(y){for(let q=0;q<b.spaceSearches.length;q++)if(Y[q]===ae)continue e}else{var M=!1;for(let q=0;q<me;q++)if(se[q]._score!==ae){M=!0;break}if(!M)continue}var he=new n(me);for(let q=0;q<me;q++)he[q]=se[q];if(y){var G=0;for(let q=0;q<b.spaceSearches.length;q++)G+=Y[q]}else{var G=ae;for(let U=0;U<me;U++){var B=he[U];if(B._score>-1e3&&G>ae){var Q=(G+B._score)/4;Q>G&&(G=Q)}B._score>G&&(G=B._score)}}if(he.obj=re,he._score=G,g!=null&&g.scoreFn){if(G=g.scoreFn(he),!G)continue;G=p(G),he._score=G}G<f||le(he)}}else for(var N=0;N<I;++N){var D=d[N];if(D&&(xe(D)||(D=w(D)),(P&D._bitflags)===P)){var B=k(b,D);B!==A&&(B._score<f||le(B))}}if(E===0)return ze;for(var ke=new Array(E),N=E-1;N>=0;--N)ke[N]=_e.poll();return ke.total=E+C,ke},e=(h,d="<b>",g="</b>")=>{for(var b=typeof d=="function"?d:void 0,P=h.target,y=P.length,f=h.indexes,x="",E=0,C=0,I=!1,le=[],ee=0;ee<y;++ee){var N=P[ee];if(f[C]===ee){if(++C,I||(I=!0,b?(le.push(x),x=""):x+=d),C===f.length){b?(x+=N,le.push(b(x,E++)),x="",le.push(P.substr(ee+1))):x+=N+g+P.substr(ee+1);break}}else I&&(I=!1,b?(le.push(b(x,E++)),x=""):x+=g);x+=N}return b?le:x},i=h=>{typeof h=="number"?h=""+h:typeof h!="string"&&(h="");var d=V(h);return o(h,{_targetLower:d._lower,_targetLowerCodes:d.lowerCodes,_bitflags:d.bitflags})},s=()=>{H.clear(),X.clear()};class r{get indexes(){return this._indexes.slice(0,this._indexes.len).sort((d,g)=>d-g)}set indexes(d){return this._indexes=d}highlight(d,g){return e(this,d,g)}get score(){return l(this._score)}set score(d){this._score=p(d)}}class n extends Array{get score(){return l(this._score)}set score(d){this._score=p(d)}}var o=(h,d)=>{var b,P,y,f,x,E,C;let g=new r;return g.target=h,g.obj=(b=d.obj)!=null?b:A,g._score=(P=d._score)!=null?P:ae,g._indexes=(y=d._indexes)!=null?y:[],g._targetLower=(f=d._targetLower)!=null?f:"",g._targetLowerCodes=(x=d._targetLowerCodes)!=null?x:A,g._nextBeginningIndexes=(E=d._nextBeginningIndexes)!=null?E:A,g._bitflags=(C=d._bitflags)!=null?C:0,g},l=h=>h===ae?0:h>1?h:Math.E**(((-h+1)**.04307-1)*-2),p=h=>h===0?ae:h>1?h:1-Math.pow(Math.log(h)/-2+1,1/.04307),m=h=>{typeof h=="number"?h=""+h:typeof h!="string"&&(h=""),h=h.trim();var d=V(h),g=[];if(d.containsSpace){var b=h.split(/\s+/);b=[...new Set(b)];for(var P=0;P<b.length;P++)if(b[P]!==""){var y=V(b[P]);g.push({lowerCodes:y.lowerCodes,_lower:b[P].toLowerCase(),containsSpace:!1})}}return{lowerCodes:d.lowerCodes,_lower:d._lower,containsSpace:d.containsSpace,bitflags:d.bitflags,spaceSearches:g}},w=h=>{if(h.length>999)return i(h);var d=H.get(h);return d!==void 0||(d=i(h),H.set(h,d)),d},S=h=>{if(h.length>999)return m(h);var d=X.get(h);return d!==void 0||(d=m(h),X.set(h,d)),d},T=(h,d)=>{var g=[];g.total=h.length;var b=(d==null?void 0:d.limit)||Ue;if(d!=null&&d.key)for(var P=0;P<h.length;P++){var y=h[P],f=Ee(y,d.key);if(f!=A){xe(f)||(f=w(f));var x=o(f.target,{_score:f._score,obj:y});if(g.push(x),g.length>=b)return g}}else if(d!=null&&d.keys)for(var P=0;P<h.length;P++){for(var y=h[P],E=new n(d.keys.length),C=d.keys.length-1;C>=0;--C){var f=Ee(y,d.keys[C]);if(!f){E[C]=K;continue}xe(f)||(f=w(f)),f._score=ae,f._indexes.len=0,E[C]=f}if(E.obj=y,E._score=ae,g.push(E),g.length>=b)return g}else for(var P=0;P<h.length;P++){var f=h[P];if(f!=A&&(xe(f)||(f=w(f)),f._score=ae,f._indexes.len=0,g.push(f),g.length>=b))return g}return g},k=(h,d,g=!1,b=!1)=>{if(g===!1&&h.containsSpace)return F(h,d,b);for(var P=h._lower,y=h.lowerCodes,f=y[0],x=d._targetLowerCodes,E=y.length,C=x.length,N=0,I=0,le=0;;){var ee=f===x[I];if(ee){if(L[le++]=I,++N,N===E)break;f=y[N]}if(++I,I>=C)return A}var N=0,re=!1,D=0,B=d._nextBeginningIndexes;B===A&&(B=d._nextBeginningIndexes=O(d.target)),I=L[0]===0?0:B[L[0]-1];var Ae=0;if(I!==C)for(;;)if(I>=C){if(N<=0||(++Ae,Ae>200))break;--N;var me=j[--D];I=B[me]}else{var ee=y[N]===x[I];if(ee){if(j[D++]=I,++N,N===E){re=!0;break}++I}else I=B[I]}var te=E<=1?-1:d._targetLower.indexOf(P,L[0]),R=!!~te,Q=R?te===0||d._nextBeginningIndexes[te-1]===te:!1;if(R&&!Q){for(var M=0;M<B.length;M=B[M])if(!(M<=te)){for(var he=0;he<E&&y[he]===d._targetLowerCodes[M+he];he++);if(he===E){te=M,Q=!0;break}}}var G=q=>{for(var U=0,Ct=0,Se=1;Se<E;++Se)q[Se]-q[Se-1]!==1&&(U-=q[Se],++Ct);var Wt=q[E-1]-q[0]-(E-1);if(U-=(12+Wt)*Ct,q[0]!==0&&(U-=q[0]*q[0]*.2),!re)U*=1e3;else{for(var wt=1,Se=B[0];Se<C;Se=B[Se])++wt;wt>24&&(U*=(wt-24)*10)}return U-=(C-E)/2,R&&(U/=1+E*E*1),Q&&(U/=1+E*E*1),U-=(C-E)/2,U};if(re)if(Q){for(var M=0;M<E;++M)L[M]=te+M;var ke=L,Le=G(L)}else var ke=j,Le=G(j);else{if(R)for(var M=0;M<E;++M)L[M]=te+M;var ke=L,Le=G(ke)}d._score=Le;for(var M=0;M<E;++M)d._indexes[M]=ke[M];d._indexes.len=E;let Ve=new r;return Ve.target=d.target,Ve._score=d._score,Ve._indexes=d._indexes,Ve},F=(h,d,g)=>{for(var b=new Set,P=0,y=A,f=0,x=h.spaceSearches,E=x.length,C=0,I=()=>{for(let Q=C-1;Q>=0;Q--)d._nextBeginningIndexes[z[Q*2+0]]=z[Q*2+1]},le=!1,R=0;R<E;++R){Z[R]=ae;var ee=x[R];if(y=k(ee,d),g){if(y===A)continue;le=!0}else if(y===A)return I(),A;var N=R===E-1;if(!N){var re=y._indexes,D=!0;for(let M=0;M<re.len-1;M++)if(re[M+1]-re[M]!==1){D=!1;break}if(D){var B=re[re.len-1]+1,Ae=d._nextBeginningIndexes[B-1];for(let M=B-1;M>=0&&Ae===d._nextBeginningIndexes[M];M--)d._nextBeginningIndexes[M]=B,z[C*2+0]=M,z[C*2+1]=Ae,C++}}P+=y._score/E,Z[R]=y._score/E,y._indexes[0]<f&&(P-=(f-y._indexes[0])*2),f=y._indexes[0];for(var me=0;me<y._indexes.len;++me)b.add(y._indexes[me])}if(g&&!le)return A;I();var te=k(h,d,!0);if(te!==A&&te._score>P){if(g)for(var R=0;R<E;++R)Z[R]=te._score/E;return te}g&&(y=d),y._score=P;var R=0;for(let Q of b)y._indexes[R++]=Q;return y._indexes.len=R,y},V=h=>{for(var d=h.length,g=h.toLowerCase(),b=[],P=0,y=!1,f=0;f<d;++f){var x=b[f]=g.charCodeAt(f);if(x===32){y=!0;continue}var E=x>=97&&x<=122?x-97:x>=48&&x<=57?26:x<=127?30:31;P|=1<<E}return{lowerCodes:b,bitflags:P,containsSpace:y,_lower:g}},ie=h=>{for(var d=h.length,g=[],b=0,P=!1,y=!1,f=0;f<d;++f){var x=h.charCodeAt(f),E=x>=65&&x<=90,C=E||x>=97&&x<=122||x>=48&&x<=57,I=E&&!P||!y||!C;P=E,y=C,I&&(g[b++]=f)}return g},O=h=>{for(var d=h.length,g=ie(h),b=[],P=g[0],y=0,f=0;f<d;++f)P>f?b[f]=P:(P=g[++y],b[f]=P===void 0?d:P);return b},H=new Map,X=new Map,L=[],j=[],z=[],Y=[],Z=[],ue=[],se=[],Ee=(h,d)=>{var g=h[d];if(g!==void 0)return g;if(typeof d=="function")return d(h);var b=d;Array.isArray(d)||(b=d.split("."));for(var P=b.length,y=-1;h&&++y<P;)h=h[b[y]];return h},xe=h=>typeof h=="object"&&typeof h._bitflags=="number",Ue=1/0,ae=-Ue,ze=[];ze.total=0;var A=null,K=i(""),oe=h=>{var d=[],g=0,b={},P=y=>{for(var f=0,x=d[f],E=1;E<g;){var C=E+1;f=E,C<g&&d[C]._score<d[E]._score&&(f=C),d[f-1>>1]=d[f],E=1+(f<<1)}for(var I=f-1>>1;f>0&&x._score<d[I]._score;I=(f=I)-1>>1)d[f]=d[I];d[f]=x};return b.add=y=>{var f=g;d[g++]=y;for(var x=f-1>>1;f>0&&y._score<d[x]._score;x=(f=x)-1>>1)d[f]=d[x];d[f]=y},b.poll=y=>{if(g!==0){var f=d[0];return d[0]=d[--g],P(),f}},b.peek=y=>{if(g!==0)return d[0]},b.replaceTop=y=>{d[0]=y,P()},b},_e=oe();return{single:a,go:t,prepare:i,cleanup:s}})});var pi={};ei(pi,{default:()=>yt});module.exports=ii(pi);v();var $=require("obsidian");v();var Re=require("obsidian");v();var De=require("obsidian"),Ot=ti(It());v();v();var Ie=require("obsidian"),je=class extends Ie.Modal{constructor(t,e,i,s,r){super(t);this.youtubeLinks=i,this.onRun=s,this.onSkip=r,this.youtubeProvider=e.youtubeProvider}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("mesh-modal"),t.createEl("h2",{text:"YouTube links detected"}),t.addClass("mesh-modal");let e=t.createEl("select");this.youtubeLinks.forEach(i=>{let s=e.createEl("option",{text:i});s.value=i}),new Ie.Setting(t).addButton(i=>{i.setButtonText("Run").setCta().onClick(async()=>{let s=e.value;if(s)try{let r=await this.youtubeProvider.getTranscript(s);this.onRun(r),this.close()}catch(r){new Ie.Notice(`Failed to fetch YouTube transcript: ${r.message}`),this.onSkip(),this.close()}else new Ie.Notice("Please select a YouTube link")})}).addButton(i=>{i.setButtonText("Skip").onClick(()=>{this.onSkip(),this.close()})})}onClose(){let{contentEl:t}=this;t.empty()}};v();var be=require("obsidian");async function Rt(c){let a=c.workspace.getActiveFile();if(a instanceof be.TFile)return await c.vault.read(a);throw new Error("No active note found")}async function fe(c,a,t){let e=c.settings.meshOutputFolder;if(!e)throw new Error("Mesh output folder not set");let i;typeof t=="string"?i=t.trim():i=t.value.trim(),i=i||"Mesh Note";let s=`${i}.md`,r=1;for(;await c.app.vault.adapter.exists(`${e}/${s}`);)s=`${i} (${r}).md`,r++;let n=`${e}/${s}`;await c.app.vault.create(n,a),new be.Notice(`File created: ${s}`);let o=c.app.vault.getAbstractFileByPath(n);o instanceof be.TFile&&await c.app.workspace.getLeaf(!1).openFile(o)}async function Ye(c,a){let t=c.app.workspace.getActiveViewOfType(be.MarkdownView);if(!t){new be.Notice("No active Markdown view found");return}let e=t.editor;if(e.getSelection()){let s=e.posToOffset(e.getCursor("from")),r=e.posToOffset(e.getCursor("to"));e.replaceRange(a,e.offsetToPos(s),e.offsetToPos(r)),new be.Notice("Content replaced selected text")}else{let s=e.getCursor();e.replaceRange(a,s),new be.Notice("Content inserted at cursor position")}}v();async function Pt(c,a,t){try{return await c.getProvider(a).generateResponse(t)}catch(e){throw u(c,`LLM Request failed: ${e}`),new Error(`LLM Request failed: ${e.message}`)}}v();var Et=`
Prompt:
<prompt>
{patternContents}
</prompt>

Input Data:
<input>
{input}
</input>

`,ce="You are a helpful assistant. Follow the instructions provided within the XML tags to process the data accurately.The prompt data should never be included in the final response. Use Markdown formatting to enhance readability.The output should not be wrapped with a markdown code block.",Ge=`
To replicate this output consistently, follow these steps:

Extract Key Topics or Phrases:

Identify significant phrases, topics, or nouns from the original document that encapsulate the main ideas. These will serve as your "backlinks" and should be concise and meaningful.

Make the Backlinks Specific to the Document Topic: Ensure that the backlinks are specific enough to distinguish them from similar topics in other documents. For example, if the document is about "EPM Integration Agent for Oracle Cloud" and the topic is "Monitoring Agent," the backlink should be "EPM Integration Agent Monitoring" or "EPM Integration Agent - SSL Configuration" instead of just "Monitoring Agent" or "SSL Configuration."

Be sure to not include any duplicate backlinks or backlinks that already exist in the input document.

Check for Existing Files:

The content data you are acting upon will always have an XML tag called <files>. This tag contains a list of files.

Determine if any of these files correspond to the backlink topic. If a file or files can be used for the backlink topic, include the files in a new key called "potential links" for that item.

This helps to avoid creating new files unnecessarily by linking to existing files.

Compose a Question for Each Backlink:

Content: Write a question that can be asked to an internet-connected LLM about the backlink topic. The question should be clear, specific, and designed to elicit informative responses about the topic.
Determine the Exact Match:

For each backlink, find the exact word-for-word string in the original content that relates to it. This will be used in the "match" field to facilitate precise matching in your program.
Format in JSON:

Structure your output as a JSON array, ensuring each item contains the "backlink", "content", "match", and (if applicable) "potential links" keys. Never should be wrapped in a code block.
Example Structure:

[
  {
    "backlink": "Specific and Meaningful Topic Related to the Document",
    "content": "Your question about the backlink topic.",
    "match": "Exact word-for-word string from the original content.",
    "potential links": ["file1", "file2"]
  },
  // Additional items...
]

Guidelines:

Backlink:

Should be a concise phrase, topic, or noun.

Reflects the main idea for the corresponding content.

Make the Backlinks Specific to the Document Topic: Include context from the document to make the backlink unique and distinguishable from similar topics in other documents.

Avoid duplicates and topics already present in the input document.

Content:

Formulate a clear and specific question about the backlink topic.

The question should be suitable for an internet-connected LLM to answer, providing up-to-date information.

Match:

Use the exact word-for-word string from the original document.

Ensure accuracy to facilitate precise text matching in your program.

Potential Links (Optional):

If any files from the <files> tag correspond to the backlink topic, include their file names in the "potential links" key.

This helps to use existing files and avoid creating new ones unnecessarily.

IMPORTANT:

The output should be a JSON array. Never should be wrapped in a code block.
`;async function He(c,a,t,e){let i=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com|youtu\.be)\/(?:watch\?v=)?(?:embed\/)?(?:v\/)?(?:shorts\/)?(?:\S+)/g,s="";switch(t){case"active-note":case"clipboard":s=t==="active-note"?await Rt(c):await navigator.clipboard.readText();let r=Array.from(s.match(i)||[]);r&&r.length>0&&(s=await new Promise(n=>{new je(c,a,r,o=>{n(`YouTube Transcript:

${o}

Original Content:

${s}`)},()=>{n(s)}).open()}));break;case"tavily":if(e){u(a,"Searching Tavily for:",e.value),s=await a.tavilyProvider.search(e.value);break}else throw new Error("Tavily search input is required")}if(!s)throw new Error("No input content available");return xt(s)}function u(c,...a){c.settings.enableDebugging&&console.log(...a)}async function pe(c,a,t,e){u(c,"Processing patterns:",t);let i=e;for(let s of t){let r=await St(c,s),n=xt(r),o=Et.replace("{patternContents}",n).replace("{input}",i);u(c,`Applying pattern: ${s}`),u(c,"Full prompt being sent to LLM:",o),i=await Pt(c,a,o)}return i}async function de(c,a,t,e){u(c,"Processing stitched patterns:",t);let i="";for(let s of t){let r=await St(c,s),n=xt(r),o=Et.replace("{patternContents}",n).replace("{input}",e),l=await Pt(c,a,o);i+=`# ${s}

---

${l}


`}return i}function xt(c){return c.replace(/\*{10,}/g,"").replace(/!{10,}/g,"").replace(/\{patternContent\}/g,"").replace(/\{input\}/g,"")}async function St(c,a){u(c,`Searching for pattern: ${a}`);async function t(i){let s=c.app.vault.getAbstractFileByPath(i);if(s instanceof De.TFolder){u(c,`Searching in folder: ${i}`);let r=s.children.filter(o=>o instanceof De.TFile);u(c,`Files in folder: ${r.map(o=>o.name).join(", ")}`);let n=r.find(o=>o.name===a);if(n||(n=r.find(o=>o.name===`${a}.md`)),n||(n=r.find(o=>o.name.toLowerCase()===a.toLowerCase())),n&&n instanceof De.TFile)return u(c,`Pattern found: ${n.path}`),n}else u(c,`Folder not found: ${i}`);return null}let e=await t(c.settings.customPatternsFolder);if(e||(e=await t(c.settings.fabricPatternsFolder)),e)return await c.app.vault.read(e);throw u(c,`Pattern '${a}' not found in custom or fabric patterns folders`),new Error(`Pattern '${a}' not found in custom or fabric patterns folders`)}async function ni(c,a,t=10){let e=[...await c.loadCustomPatterns(),...await c.loadFabricPatterns()];return Ot.go(a,e,{limit:t})}async function Te(c,a,t,e,i){if(t.empty(),a.length===0){t.addClass("hidden"),i([]);return}let s=await ni(c,a);if(s.length>0){let r=[];s.forEach((n,o)=>{let l=t.createEl("div",{text:n.target,cls:"pattern-result"});l.addEventListener("click",()=>e(n.target)),r.push(l)}),t.removeClass("hidden"),i(r)}else t.addClass("hidden"),i([])}function Pe(c,a,t,e,i){a.includes(c)||(a.push(c),t()),e(),i()}function ye(c,a,t,e){a.empty(),t.forEach(i=>{let s=ai(i,r=>{let n=t.filter(o=>o!==r);c.addClass("hidden"),e(n),ye(c,a,n,e)});a.appendChild(s),c.removeClass("hidden")})}function ai(c,a){let t=document.createElement("div");return t.textContent=c,t.className="selected-pattern",t.createEl("span",{text:"\xD7",cls:"remove-pattern"}).addEventListener("click",()=>a(c)),t}v();var Je=class{constructor(a){this.containerEl=a}static createSelect(a,t,e){let i=(a instanceof HTMLElement,a).createEl("select",{cls:t});return e.forEach(s=>{i.createEl("option",{value:s,text:s})}),i}createUI(a,t){this.containerEl.empty(),this.containerEl.addClass("mesh-ai-container");let e=this.containerEl.createEl("h2",{text:"Mesh AI"}),i=this.createProviderSelect(a),s=this.createPromptInput();this.createSubmitButton().addEventListener("click",()=>{let o=i.value,l=s.value;l&&t(o,l)});let n=this.containerEl.createEl("div",{cls:"mesh-ai-response"});return{updateResponse:o=>{n.empty(),n.createEl("pre").setText(o)},showLoading:()=>{n.empty(),n.createEl("div",{text:"Processing...",cls:"mesh-ai-loading"})},hideLoading:()=>{n.empty()}}}createProviderSelect(a){let t=this.containerEl.createEl("div",{cls:"mesh-ai-select-container"});t.createEl("label",{text:"Select provider:",attr:{for:"mesh-ai-provider"}});let e=t.createEl("select",{cls:"mesh-ai-select",attr:{id:"mesh-ai-provider"}});return[{value:"openai",label:"OpenAI"},{value:"grocq",label:"Grocq"},{value:"ollama",label:"Ollama"},{value:"openrouter",label:"OpenRouter"},{value:"lmstudio",label:"LMStudio"}].forEach(s=>{let r=e.createEl("option",{value:s.value,text:s.label});this.isProviderConfigured(s.value,a)?r.disabled=!1:r.disabled=!0}),e}isProviderConfigured(a,t){return a==="ollama"?!!t.ollamaServerUrl:!!t[`${a}ApiKey`]}createPromptInput(){let a=this.containerEl.createEl("div",{cls:"mesh-ai-input-container"});return a.createEl("label",{text:"Enter your prompt:",attr:{for:"mesh-ai-prompt"}}),a.createEl("textarea",{cls:"mesh-ai-input",attr:{id:"mesh-ai-prompt",rows:"4"}})}createSubmitButton(){return this.containerEl.createEl("button",{cls:"mesh-ai-submit",text:"Submit"})}};v();var Nt=require("obsidian"),Xe=class extends Nt.FuzzySuggestModal{constructor(t,e,i){super(t);this.models=e,this.onChoose=i}getItems(){return this.models}getItemText(t){return t}onChooseItem(t,e){this.onChoose(t)}};var Oe="mesh-view",qe=class extends Re.ItemView{constructor(t,e){super(t);this.selectedPatterns=[];this.currentSelectedIndex=-1;this.patternResultElements=[];this.handleClickOutside=t=>{(!(t.target instanceof Node)||!this.patternResults.contains(t.target))&&this.patternResults.addClass("hidden")};this.plugin=e,this.patternStitchingEnabled=this.plugin.settings.patternStitchingEnabled,this.currentProvider=this.plugin.settings.selectedProvider}getViewType(){return Oe}getDisplayText(){return"Mesh AI"}async onOpen(){let t=this.containerEl.children[1];t.empty(),t.addClass("mesh-view-container"),this.registerEvent(this.app.workspace.on("layout-change",this.onLayoutChange.bind(this))),this.registerEvent(this.app.workspace.on("resize",this.onLayoutChange.bind(this)));let e=t.createEl("div",{cls:"particles-js",attr:{id:"particles-js"}}),i=t.createEl("div",{cls:"mesh-form-container"});this.isProviderConfigured(this.plugin.settings.selectedProvider)||t.createEl("div",{cls:"mesh-overlay"}).createEl("p",{text:"The default provider selected is not configured."});let r={openai:"openai",ollama:"ollama",openrouter:"openrouter",grocq:"grocq",lmstudio:"lmstudio"},n=this.createCard(i,"provider"),o=Je.createSelect(n,"mesh-provider-select",Object.values(r));o.value=this.currentProvider;let p=n.createEl("div",{cls:"mesh-model-container"}).createEl("p",{cls:"mesh-model-text"}),m=p.createEl("span",{text:"powered by ",cls:"mesh-powered-by"});this.modelNameSpan=p.createEl("span",{cls:"mesh-model-name"});let w=p.createEl("span",{cls:"mesh-model-edit-icon",text:"\u270F\uFE0F"}),S=A=>{let K=this.modelNameSpan.querySelector(".mesh-model-name-old")||this.modelNameSpan.cloneNode(!0),oe=this.modelNameSpan.querySelector(".mesh-model-name-new")||this.modelNameSpan.cloneNode(!0);K.textContent=this.modelNameSpan.textContent,oe.textContent=A,K.classList.add("mesh-model-name-old"),oe.classList.add("mesh-model-name-new"),this.modelNameSpan.innerHTML="",this.modelNameSpan.appendChild(K),this.modelNameSpan.appendChild(oe),this.modelNameSpan.offsetWidth,this.modelNameSpan.classList.add("changing"),setTimeout(()=>{this.modelNameSpan.classList.remove("changing"),this.modelNameSpan.textContent=A},600)},T=async()=>{let K=await this.plugin.getProvider(this.currentProvider).getAvailableModels(),oe=this.plugin.settings.providerModels[this.currentProvider][0]||K[0];S(oe)};await T();let k=()=>{this.plugin.getProvider(this.currentProvider).getAvailableModels().then(K=>{new Xe(this.app,K,oe=>{this.plugin.settings.providerModels[this.currentProvider]=[oe],this.plugin.saveSettings(),S(oe)}).open()})};this.modelNameSpan.addEventListener("click",k),w.addEventListener("click",k),o.addEventListener("change",async A=>{this.currentProvider=A.target.value,await T()});let F=this.createCard(i,"Input"),V=F.createEl("div",{cls:"input-toggle-container"}),ie=V.createEl("div",{cls:"input-toggle-slider mesh-slider"});[{value:"active-note",text:"Note",icon:"\u{1F4DD}"},{value:"clipboard",text:"Clipboard",icon:"\u{1F4CB}"},{value:this.plugin.settings.usePerplexity?"perplexity":"tavily",text:this.plugin.settings.usePerplexity?"Perplexity":"Tavily",icon:"\u{1F50D}"}].forEach((A,K)=>{let oe=V.createEl("label",{cls:"input-toggle-label"}),_e=oe.createEl("input",{attr:{type:"radio",name:"input-source",value:A.value},cls:"input-toggle-input"});A.value==="note"&&(_e.checked=!0),oe.createEl("span",{text:A.text,cls:"input-toggle-text"}),oe.createEl("span",{text:A.icon,cls:"input-toggle-icon"}),_e.addEventListener("change",()=>{this.handleInputSourceChange(A.value,K)})});let X=F.createEl("div",{cls:"tavily-search-container"}).createEl("input",{attr:{type:"text",placeholder:this.plugin.settings.usePerplexity?"Enter Perplexity search query":"Enter Tavily search query"},cls:"mesh-tavily-input tavily-hidden"}),L=this.createCard(i,"patterns"),j=L.createEl("div",{cls:"pattern-search-container"});this.patternInput=new Re.TextComponent(j).setPlaceholder("Search patterns...").onChange(A=>{Te(this.plugin,A,this.patternResults,this.handlePatternSelect.bind(this),K=>{this.patternResultElements=K,this.currentSelectedIndex=K.length>0?0:-1,this.highlightCurrentResult()})}),this.patternResults=j.createEl("div",{cls:"pattern-results"}),this.patternInput.inputEl.addClass("pattern-search-input"),this.patternInput.inputEl.addEventListener("keydown",this.handlePatternInputKeydown.bind(this)),L.createEl("h4",{text:"Selected patterns",cls:"mesh-selected-patterns-title"}).addClass("hidden"),this.selectedPatternsContainer=L.createEl("div",{cls:"selected-patterns-container"});let Y=L.createEl("div",{cls:"pattern-stitching-container"}),Z=Y.createEl("label",{cls:"switch"}),ue=Z.createEl("input",{type:"checkbox",cls:"pattern-stitching-input"});ue.checked=this.patternStitchingEnabled;let se=Z.createEl("span",{cls:"mesh-slider round"}),Ee=Y.createEl("span",{text:"Pattern stitching",cls:"pattern-stitching-label"});ue.addEventListener("change",A=>{this.patternStitchingEnabled=A.target.checked,this.plugin.settings.patternStitchingEnabled=this.patternStitchingEnabled,this.plugin.saveSettings();let K=this.patternStitchingEnabled?"enabled":"disabled";K==="enabled"?se.addClass("stitching-enabled"):se.removeClass("stitching-enabled"),new Re.Notice(`Pattern Stitching ${K}.`)});let xe=this.createCard(i,"output");this.outputFileNameInput=xe.createEl("input",{type:"text",placeholder:"Output file name (optional)",cls:"mesh-output-filename-input"}),i.createEl("div",{cls:"mesh-submit-button-container"}).createEl("button",{text:"Submit",cls:"mesh-submit-button"}).addEventListener("click",this.onSubmit.bind(this)),this.loadingElement=t.createEl("div",{text:"Processing...",cls:"mesh-loading"}),this.loadingElement.hide(),setTimeout(()=>this.initParticles(),100),document.addEventListener("click",this.handleClickOutside),setTimeout(()=>{t.addClass("loaded")},100),this.registerInterval(window.setInterval(()=>{let A=this.containerEl.offsetWidth;this.adjustLayoutForWidth(A)},100)),this.isProviderConfigured(this.plugin.settings.selectedProvider)?u(this.plugin,"Provider configured"):(u(this.plugin,"Provider not configured"),t.createEl("div",{cls:"mesh-overlay"}).createEl("p",{text:"The default provider selected is not configured."}))}initParticles(){let t=this.containerEl.children[1],e=t.querySelector("#particles-js");e||(e=t.createEl("div",{cls:"particles-js",attr:{id:"particles-js"}}));let i=()=>{typeof window.pJSDom!="undefined"&&window.pJSDom.length>0&&(window.pJSDom[0].pJS.fn.vendors.destroypJS(),window.pJSDom=[])},s=()=>{if(typeof window.particlesJS=="function"&&e.clientWidth>0&&e.clientHeight>0){i();try{window.particlesJS("particles-js",{particles:{number:{value:120,density:{enable:!0,value_area:1e3}},color:{value:["#81a0ed","#694daa","#9c27b0","#3f51b5"]},shape:{type:["circle","triangle"],polygon:{nb_sides:5}},opacity:{value:.5,random:!0,anim:{enable:!0,speed:.8,opacity_min:.1,sync:!1}},size:{value:3,random:!0,anim:{enable:!0,speed:1.5,size_min:.1,sync:!1}},line_linked:{enable:!0,distance:200,color:"#81a0ed",opacity:.3,width:1},move:{enable:!0,speed:1.5,direction:"none",random:!0,straight:!1,out_mode:"bounce",bounce:!1,attract:{enable:!1,rotateX:600,rotateY:1200}}},interactivity:{detect_on:"canvas",events:{onhover:{enable:!0,mode:"grab"},onclick:{enable:!0,mode:"push"},resize:!0},modes:{grab:{distance:150,line_linked:{opacity:.5}},push:{particles_nb:3}}},retina_detect:!0})}catch(n){console.error("Error initializing particles:",n)}}};s();let r=new ResizeObserver(this.debounce(()=>{let n=e.querySelector("canvas");n&&(n.width=e.clientWidth,n.height=e.clientHeight),s()},200));return r.observe(t),()=>{r.disconnect(),i()}}debounce(t,e){let i=null;return(...s)=>{i&&clearTimeout(i),i=setTimeout(()=>t(...s),e)}}createCard(t,e){let i=t.createEl("div",{cls:`mesh-card ${e.toLowerCase()}`});return i.createEl("h3",{text:e,cls:"mesh-card-title"}),i}updateTheme(){let t=document.body.classList.contains("theme-dark");this.containerEl.toggleClass("theme-dark",t),this.containerEl.toggleClass("theme-light",!t)}async onSubmit(){u(this.plugin,"onSubmit method called");let t=this.containerEl.querySelector('input[name="input-source"]:checked'),e=this.containerEl.querySelector(".mesh-tavily-input"),i=this.currentProvider,s=t?t.value:"active-note",r=this.selectedPatterns;try{await this.showLoading(),this.startRotating(this.providerCard),await new Promise(l=>setTimeout(l,2e3)),this.stopRotating(this.providerCard),this.startRotating(this.inputCard),await new Promise(l=>setTimeout(l,2e3)),u(this.plugin,"Getting input content...");let n;s==="tavily"||s==="perplexity"?n=await this.getSearchProviderContent(s,e.value):n=await He(this.app,this.plugin,s,e),this.stopRotating(this.inputCard),this.startRotating(this.patternsCard),await new Promise(l=>setTimeout(l,2e3)),u(this.plugin,"Processing patterns...");let o;this.patternStitchingEnabled?o=await de(this.plugin,i,r,n):o=await pe(this.plugin,i,r,n),this.stopRotating(this.patternsCard),this.startRotating(this.outputCard),await new Promise(l=>setTimeout(l,2e3)),u(this.plugin,"Creating output file..."),await fe(this.plugin,o,this.outputFileNameInput),this.stopRotating(this.outputCard)}catch(n){console.error("Error processing request:",n),new Re.Notice(`Error: ${n instanceof Error?n.message:String(n)}`)}finally{this.hideLoading()}}async getSearchProviderContent(t,e){let i=this.plugin.getSearchProvider(t);if("search"in i)return await i.search(e);throw new Error(`Provider ${t} does not support search method`)}async showLoading(){let t=this.containerEl.querySelector(".mesh-form-container"),e=Array.from(t.querySelectorAll(".mesh-card")),i=this.containerEl.querySelector(".mesh-submit-button-container"),s=i.querySelector(".mesh-submit-button");this.providerCard=e[0],this.inputCard=e[1],this.patternsCard=e[2],this.outputCard=e[3],this.startRotating=r=>{r.classList.add("rotating")},this.stopRotating=r=>{r.classList.remove("rotating")},i.classList.add("processing"),s.classList.add("processing"),s.disabled=!0,s.textContent="Processing..."}hideLoading(){let t=this.containerEl.querySelector(".mesh-form-container"),e=Array.from(t.querySelectorAll(".mesh-card")),i=this.containerEl.querySelector(".mesh-submit-button-container"),s=i.querySelector(".mesh-submit-button");e.forEach(r=>{r.classList.remove("rotating")}),i.classList.remove("processing"),s.classList.remove("processing"),s.disabled=!1,s.textContent="Submit"}handleInputSourceChange(t,e){let i=this.containerEl.querySelector(".mesh-tavily-input");this.containerEl.querySelector(".input-toggle-slider").setAttribute("data-position",e.toString()),t==="tavily"||t==="perplexity"?(i.classList.remove("tavily-hidden"),i.placeholder=this.plugin.settings.usePerplexity?"Enter Perplexity search query":"Enter Tavily search query"):i.classList.add("tavily-hidden")}handlePatternInputKeydown(t){(t.key==="ArrowDown"||t.key==="ArrowUp"||t.key==="Enter")&&(t.preventDefault(),t.key==="ArrowDown"?this.navigatePatternResults(1):t.key==="ArrowUp"?this.navigatePatternResults(-1):t.key==="Enter"&&this.selectCurrentPattern())}navigatePatternResults(t){let e=this.patternResultElements.length;e!==0&&(this.currentSelectedIndex=(this.currentSelectedIndex+t+e)%e,this.highlightCurrentResult())}highlightCurrentResult(){this.patternResultElements.forEach((t,e)=>{t.classList.toggle("selected",e===this.currentSelectedIndex)})}selectCurrentPattern(){var t;if(this.currentSelectedIndex>=0&&this.currentSelectedIndex<this.patternResultElements.length){let i=((t=this.patternResultElements[this.currentSelectedIndex].textContent)==null?void 0:t.trim())||"";this.handlePatternSelect(i)}}handlePatternSelect(t){Pe(t,this.selectedPatterns,()=>ye(this.containerEl.querySelector(".mesh-selected-patterns-title"),this.selectedPatternsContainer,this.selectedPatterns,e=>{this.selectedPatterns=e}),()=>this.patternInput.setValue(""),()=>{this.patternResults.empty(),this.patternResultElements=[],this.currentSelectedIndex=-1})}onLayoutChange(){this.initParticles()}setupResizeObserver(){new ResizeObserver(e=>{for(let i of e){let s=i.contentRect.width;this.adjustLayoutForWidth(s)}}).observe(this.containerEl)}adjustLayoutForWidth(t){let e=this.containerEl.querySelector(".mesh-view-container"),i=Array.from(e.querySelectorAll(".mesh-card")),s=Array.from(this.containerEl.querySelectorAll(".input-toggle-label"));t<409?s.forEach(r=>{let n=r.querySelector(".input-toggle-text"),o=r.querySelector(".input-toggle-icon");n&&o&&(n.style.display="none",o.style.display="inline")}):s.forEach(r=>{let n=r.querySelector(".input-toggle-text"),o=r.querySelector(".input-toggle-icon");n&&o&&(n.style.display="inline",o.style.display="none")})}async onClose(){let t=this.initParticles();this.setupResizeObserver(),t(),document.removeEventListener("click",this.handleClickOutside)}isProviderConfigured(t){let e=t==="ollama"?this.plugin.settings.ollamaServerUrl:this.plugin.settings[`${t}ApiKey`],i=this.plugin.settings.providerModels[t];return!!e&&i.length>0}};v();var _=require("obsidian");var Qe=class extends _.PluginSettingTab{constructor(t,e){super(t,e);this.plugin=e}async display(){let{containerEl:t}=this;t.empty();let e=["openai","google","microsoft","anthropic","grocq","openrouter","ollama","lmstudio"],i=["openai","grocq","ollama","openrouter","lmstudio"];for(let n of e){let o=t.createEl("div",{cls:"mesh-provider-container"});o.createEl("h3",{text:n.charAt(0).toUpperCase()+n.slice(1)}),i.includes(n)||o.createEl("div",{cls:"mesh-overlay"}).createEl("p",{text:"Coming soon"}),n==="ollama"?new _.Setting(o).setName("Ollama server URL").setDesc("Enter the URL for your Ollama server").addText(p=>p.setPlaceholder("Enter URL").setValue(this.plugin.settings.ollamaServerUrl).onChange(async m=>{this.plugin.settings.ollamaServerUrl=m,await this.plugin.saveSettings()})):n==="microsoft"?(new _.Setting(o).setName("Microsoft Azure API key").setDesc("Enter your Microsoft Azure API key").addText(p=>p.setPlaceholder("Enter API key").setValue(this.plugin.settings.microsoftApiKey).onChange(async m=>{this.plugin.settings.microsoftApiKey=m,await this.plugin.saveSettings()})),new _.Setting(o).setName("Microsoft Azure Endpoint URL").setDesc("Enter your Microsoft Azure Endpoint URL").addText(p=>p.setPlaceholder("Enter Endpoint URL").setValue(this.plugin.settings.microsoftEndpointUrl||"").onChange(async m=>{this.plugin.settings.microsoftEndpointUrl=m,await this.plugin.saveSettings()}))):n==="lmstudio"?new _.Setting(o).setName("LMStudio server URL").setDesc("Enter the URL for your LMStudio server").addText(p=>p.setPlaceholder("Enter URL").setValue(this.plugin.settings.lmstudioServerUrl).onChange(async m=>{this.plugin.settings.lmstudioServerUrl=m,await this.plugin.saveSettings()})):new _.Setting(o).setName("API key").setDesc(`Enter your ${n} API key`).addText(p=>p.setPlaceholder("Enter API key").setValue(this.plugin.settings[`${n}ApiKey`]).onChange(async m=>{this.plugin.settings[`${n}ApiKey`]=m,await this.plugin.saveSettings()})).addButton(p=>p.setButtonText("Test API Key").onClick(async()=>{await this.testApiKey(n)}));let l=new _.Setting(o).setName("Model").setDesc(`Select the model for ${n}`).addDropdown(async p=>{await this.populateModelDropdown(p,n)});l.addButton(p=>{p.setButtonText("Refresh models").onClick(async()=>{let m=l.components[0];await this.populateModelDropdown(m,n,!0)})})}new _.Setting(t).setName("Default Provider").setDesc("Select the default AI provider. You must reload the plugin for the change to take effect.").addDropdown(n=>{i.forEach(o=>{n.addOption(o,o.charAt(0).toUpperCase()+o.slice(1))}),n.setValue(this.plugin.settings.selectedProvider),n.onChange(async o=>{this.plugin.settings.selectedProvider=o,await this.plugin.saveSettings()})}),new _.Setting(t).setName("Use Perplexity").setDesc("Enable Perplexity integration (disables Tavily)").addToggle(n=>n.setValue(this.plugin.settings.usePerplexity).onChange(async o=>{this.plugin.settings.usePerplexity=o,await this.plugin.saveSettings(),this.display()}));let s=t.createEl("div",{cls:"setting-item-description",text:"Note: Currently, the Perplexity API does not support returning citations or images as these features are in closed beta. Additionally, the Perplexity API is a paid feature. After enabling Perplexity close and reopen the plugin for the change to take effect."});s.style.marginTop="10px",s.style.marginBottom="20px",s.style.color="var(--text-muted)",this.plugin.settings.usePerplexity?new _.Setting(t).setName("Perplexity API Key").setDesc("Enter your Perplexity API key").addText(n=>n.setPlaceholder("Enter API key").setValue(this.plugin.settings.perplexityApiKey).onChange(async o=>{this.plugin.settings.perplexityApiKey=o,await this.plugin.saveSettings()})):new _.Setting(t).setName("Tavily API key").setDesc("Enter your Tavily API key").addText(n=>n.setPlaceholder("Enter API key").setValue(this.plugin.settings.tavilyApiKey).onChange(async o=>{this.plugin.settings.tavilyApiKey=o,await this.plugin.saveSettings()})),new _.Setting(t).setName("YouTube API key").setDesc("Enter your YouTube API key for transcript fetching").addText(n=>n.setPlaceholder("Enter API key").setValue(this.plugin.settings.youtubeApiKey).onChange(async o=>{this.plugin.settings.youtubeApiKey=o,await this.plugin.saveSettings()})),new _.Setting(t).setName("YouTube yt-dlp path").setDesc("Optional: Absolute path to yt-dlp binary (Fabric method). If empty, will try system PATH.").addText(n=>n.setPlaceholder("/opt/homebrew/bin/yt-dlp").setValue(this.plugin.settings.youtubeYtDlpPath||"").onChange(async o=>{this.plugin.settings.youtubeYtDlpPath=o,await this.plugin.saveSettings()})),new _.Setting(t).setName("Custom patterns folder").setDesc("Enter the path to your custom patterns folder").addText(n=>n.setPlaceholder("Custom Patterns").setValue(this.plugin.settings.customPatternsFolder).onChange(async o=>{this.plugin.settings.customPatternsFolder=o.replace(/\\/g,"/"),await this.plugin.saveSettings()})),new _.Setting(t).setName("Fabric patterns folder").setDesc("Enter the path to the fabric patterns folder").addText(n=>n.setPlaceholder("Fabric Patterns").setValue(this.plugin.settings.fabricPatternsFolder).onChange(async o=>{this.plugin.settings.fabricPatternsFolder=o.replace(/\\/g,"/"),await this.plugin.saveSettings()})),new _.Setting(t).setName("Download patterns").setDesc("Download patterns from GitHub").addButton(n=>{n.setButtonText("Download").onClick(async()=>{let o=n.buttonEl.textContent||"Download";n.setDisabled(!0),n.buttonEl.addClass("loading"),n.setButtonText("Downloading...");try{await this.plugin.downloadPatternsFromGitHub(),new _.Notice("Patterns downloaded successfully")}catch(l){console.error("Error downloading patterns:",l),new _.Notice(`Failed to download patterns: ${l instanceof Error?l.message:String(l)}`)}finally{n.setDisabled(!1),n.buttonEl.removeClass("loading"),n.setButtonText(o),this.display()}})}),new _.Setting(t).setName("Mesh output folder").setDesc("Enter the name of the folder for Mesh AI output. If it's in the root of your vault, just enter the folder name.").addText(n=>n.setPlaceholder("Mesh Output").setValue(this.plugin.settings.meshOutputFolder).onChange(async o=>{this.plugin.settings.meshOutputFolder=o.replace(/\\/g,"/"),await this.plugin.saveSettings()})),this.containerEl.createEl("h2",{text:"Workflows"}),this.workflowContainer=this.containerEl.createEl("div"),this.displayWorkflows(),new _.Setting(this.containerEl).setName("Add Workflow").addButton(n=>n.setButtonText("Add").onClick(()=>this.addWorkflow())),this.containerEl.createEl("h2",{text:"Pathways Settings"});let r=this.containerEl.createEl("div",{cls:"setting-item-description",text:"Analyzing pathways is supported via OpenRouter using reasoning-capable models. Select a cost-effective reasoning model below; the app will fall back automatically if a model becomes unavailable."});r.style.marginBottom="20px",r.style.color="var(--text-muted)",new _.Setting(this.containerEl).setName("Pathways Model (OpenRouter)").setDesc("Select the model to use for pathway analysis").addDropdown(async n=>{try{let o=await this.getModelsForProvider("openrouter");if(n.selectEl.empty(),o&&o.length>0){o.forEach(m=>n.addOption(m,m));let l=this.plugin.settings.pathwaysModel,p=l&&o.includes(l)?l:o[0];n.setValue(p),this.plugin.settings.pathwaysModel=p,await this.plugin.saveSettings()}else n.addOption("openai/gpt-4o-mini","openai/gpt-4o-mini"),n.setValue("openai/gpt-4o-mini"),this.plugin.settings.pathwaysModel="openai/gpt-4o-mini",await this.plugin.saveSettings();n.onChange(async l=>{this.plugin.settings.pathwaysModel=l,await this.plugin.saveSettings()})}catch(o){n.addOption("openai/gpt-4o-mini","openai/gpt-4o-mini"),n.setValue("openai/gpt-4o-mini"),this.plugin.settings.pathwaysModel="openai/gpt-4o-mini",await this.plugin.saveSettings()}}),new _.Setting(this.containerEl).setName("Pathways Output Folder").setDesc("Enter the path for the Pathways output folder").addText(n=>n.setPlaceholder("Pathways").setValue(this.plugin.settings.pathwaysOutputFolder).onChange(async o=>{this.plugin.settings.pathwaysOutputFolder=o,await this.plugin.saveSettings()})),new _.Setting(this.containerEl).setName("Default Pathway Workflow").setDesc("Select the default workflow to use for pathway creation. This workflow will be used to create backlinks for each pathway.").addDropdown(n=>{this.plugin.settings.workflows.forEach(o=>{n.addOption(o.name,o.name)}),n.setValue(this.plugin.settings.defaultPathwayWorkflow||"").onChange(async o=>{this.plugin.settings.defaultPathwayWorkflow=o,await this.plugin.saveSettings()})}),new _.Setting(t).setName("Enable debugging").setDesc("Turn on console logging for debugging purposes").addToggle(n=>n.setValue(this.plugin.settings.enableDebugging).onChange(async o=>{this.plugin.settings.enableDebugging=o;let l=this.plugin.settings.enableDebugging?"enabled":"disabled";new _.Notice(`Debugging ${l}.`),await this.plugin.saveSettings()}))}displayWorkflows(){this.workflowContainer.empty(),this.plugin.settings.workflows.forEach((t,e)=>{let i=new _.Setting(this.workflowContainer).setName(`Workflow ${e+1}`).addText(s=>s.setPlaceholder("Workflow name").setValue(t.name).onChange(async r=>{t.name=r,await this.plugin.saveSettings(),this.plugin.createWorkflowCommands()})).addDropdown(s=>{["openai","google","microsoft","anthropic","grocq","ollama","openrouter"].forEach(n=>s.addOption(n,n)),s.setValue(t.provider).onChange(async n=>{t.provider=n,await this.plugin.saveSettings(),this.plugin.createWorkflowCommands()})}).addText(s=>s.setPlaceholder("Pattern names (comma-separated)").setValue(t.patterns.join(", ")).onChange(async r=>{t.patterns=r.split(",").map(n=>n.trim()),await this.plugin.saveSettings(),this.plugin.createWorkflowCommands()})).addToggle(s=>s.setValue(t.usePatternStitching).setTooltip("Use pattern stitching").onChange(async r=>{t.usePatternStitching=r,await this.plugin.saveSettings()})).addButton(s=>s.setButtonText("Delete").onClick(async()=>{this.plugin.settings.workflows.splice(e,1),await this.plugin.saveSettings(),this.displayWorkflows(),this.plugin.createWorkflowCommands()}))})}async addWorkflow(){this.plugin.settings.workflows.push({name:"New Workflow",provider:"openai",patterns:[],usePatternStitching:!1}),await this.plugin.saveSettings(),this.displayWorkflows(),this.plugin.createWorkflowCommands()}async populateModelDropdown(t,e,i=!1){var s;t.selectEl.disabled=!0;try{let r;if(i?(r=await this.getModelsForProvider(e),this.plugin.settings.providerModels[e]=r,await this.plugin.saveSettings()):r=this.plugin.settings.providerModels[e]||await this.getModelsForProvider(e),t.selectEl.empty(),r&&r.length>0){r.forEach(l=>t.addOption(l,l));let n=(s=this.plugin.settings.providerModels[e])==null?void 0:s[0],o=r.includes(n)?n:r[0];t.setValue(o),this.plugin.settings.providerModels[e]=[o],await this.plugin.saveSettings(),t.onChange(async l=>{this.plugin.settings.providerModels[e]=[l],await this.plugin.saveSettings(),u(this.plugin,`Model for ${e} set to: ${l}`)})}else t.addOption("","No models available"),u(this.plugin,`No models available for ${e}`)}catch(r){u(this.plugin,`Error fetching models for ${e}:`,r),t.addOption("error","Error fetching models")}finally{t.selectEl.disabled=!1}}async getModelsForProvider(t){try{let e=this.plugin.getProvider(t);if(e&&"getAvailableModels"in e)return await e.getAvailableModels()}catch(e){u(this.plugin,`Error fetching models for ${t}:`,e)}return this.plugin.settings.providerModels[t]||[]}async testApiKey(t){try{if(!(t==="ollama"?this.plugin.settings.ollamaServerUrl:this.plugin.settings[`${t}ApiKey`])){new _.Notice(`Please enter an API key for ${t}`);return}await this.plugin.getProvider(t).getAvailableModels(),new _.Notice(`API key for ${t} is valid`);let s=this.containerEl.querySelector(`.mesh-provider-setting[data-provider="${t}"] .dropdown`);if(s){let r=new _.DropdownComponent(s);await this.populateModelDropdown(r,t,!0)}}catch(e){console.error(`Error testing API key for ${t}:`,e),new _.Notice(`Failed to validate API key for ${t}: ${e.message}`)}}hide(){super.hide(),this.plugin.reloadMeshView()}};v();var $t={openaiApiKey:"",googleApiKey:"",microsoftApiKey:"",anthropicApiKey:"",grocqApiKey:"",tavilyApiKey:"",openrouterApiKey:"",usePerplexity:!1,perplexityApiKey:"",youtubeApiKey:"",youtubeYtDlpPath:"",ollamaServerUrl:"http://localhost:11434",microsoftEndpointUrl:"",selectedProvider:"openrouter",selectedModel:"",providerModels:{openai:[],google:[],microsoft:[],anthropic:[],grocq:[],ollama:[],openrouter:[],lmstudio:[]},customPatternsFolder:"",fabricPatternsFolder:"",meshOutputFolder:"",patternStitchingEnabled:!1,enableDebugging:!1,workflows:[],lmstudioApiKey:"",lmstudioServerUrl:"http://localhost:8000",pathwaysModel:"openai/gpt-4o-mini",pathwaysOutputFolder:"",defaultPathwayWorkflow:"",pathwaysSearchProvider:"tavily"};v();v();var At=require("obsidian");var W=class{constructor(a,t,e){this.baseUrl=a,this.headers=t,this.plugin=e}async get(a){return this.request(a,"GET")}async post(a,t,e=!1){return this.request(a,"POST",t,e)}async request(a,t,e,i=!1){let r={url:`${this.baseUrl}${a}`,method:t,headers:this.headers,contentType:"application/json"};e&&(r.body=JSON.stringify(e));try{let n=await(0,At.requestUrl)(r);if(n.status<200||n.status>=300)throw u(this.plugin,`HTTP error! status: ${n.status}`),u(this.plugin,`Response text: ${n.text}`),new Error(`HTTP error! status: ${n.status} - ${n.text}`);return i?n:n.json}catch(n){throw u(this.plugin,`Request error: ${n.message}`),n}}async postStream(a,t,e){let s={url:`${this.baseUrl}${a}`,method:"POST",headers:{"Content-Type":"application/json",...this.headers},body:JSON.stringify(t),throw:!1};try{let n=await(await(0,At.requestUrl)(s)).arrayBuffer,l=new TextDecoder().decode(n).split(`
`).filter(p=>p.trim()!=="");for(let p of l)if(p.startsWith("data: ")){let m=p.slice(6);if(m==="[DONE]")break;try{let w=JSON.parse(m);e(w)}catch(w){u(this.plugin,`Error parsing JSON: ${w}`)}}}catch(r){throw u(this.plugin,`Error in postStream: ${r}`),r}}};var Ze=class{constructor(a,t){this.plugin=t,this.apiHelper=new W("https://api.openai.com/v1",{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},this.plugin)}async generateResponse(a,t){let e=this.plugin.settings.providerModels.openai,i=e&&e.length>0?e[0]:"gpt-3.5-turbo";if(u(this.plugin,`Using OpenAI model: ${i}`),!i)throw new Error("No OpenAI model has been selected. Please choose a model in the settings.");let s="/chat/completions",r={model:i,messages:[{role:"system",content:ce},{role:"user",content:a}],stream:!!t};try{if(t){let n="";return await this.apiHelper.postStream(s,r,o=>{if(o.choices&&o.choices[0].delta&&o.choices[0].delta.content){let l=o.choices[0].delta.content;n+=l,t(l)}}),n.trim()}else{let n=await this.apiHelper.post(s,r);if(n.choices&&n.choices[0]&&n.choices[0].message)return n.choices[0].message.content.trim();throw new Error("Unexpected response format from OpenAI API")}}catch(n){throw u(this.plugin,`Error generating response with model ${i}: ${n}`),n.response&&(u(this.plugin,`Response status: ${n.response.status}`),u(this.plugin,`Response data: ${JSON.stringify(n.response.data)}`)),new Error(`Failed to generate response: ${n.message}`)}}async getAvailableModels(){try{let a=await this.apiHelper.get("/models");if(!a)throw new Error("No response received from OpenAI API");if(a.error)throw new Error(`API Error: ${a.error.message||"Unknown error"}`);if(a.data&&Array.isArray(a.data))return a.data.filter(t=>t.id.startsWith("gpt-")).map(t=>t.id);throw new Error("Unexpected response format from OpenAI API")}catch(a){throw u(this.plugin,`Error fetching OpenAI models: ${a}`),a.response&&(u(this.plugin,`Response status: ${a.response.status}`),u(this.plugin,`Response data: ${JSON.stringify(a.response.data)}`)),a}}};v();var Ft=require("obsidian");var et=class{constructor(a,t){this.apiHelper=new W("https://generativelanguage.googleapis.com/v1beta",{"x-goog-api-key":a},this.plugin),this.plugin=t}async getAvailableModels(){try{let a=await this.apiHelper.post("/models",{});if(a.models&&Array.isArray(a.models))return a.models.filter(t=>t.supportedGenerationMethods.includes("generateContent")).map(t=>t.name);throw new Error("Unexpected response format from Google API")}catch(a){throw u(this.plugin,`Error fetching Google models: ${a}`),a}}async generateResponse(a,t){let e=this.plugin.settings.providerModels.google,i=e&&e.length>0?e[0]:"chat-bison-001";i||new Ft.Notice('No Google model has been selected. Using default model "chat-bison-001".');let s="";try{return await this.apiHelper.postStream(`/models/${i}:streamGenerateContent`,{contents:[{parts:[{text:a}]}],safety_settings:[{category:"HARM_CATEGORY_DANGEROUS",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HARASSMENT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_HATE_SPEECH",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_SEXUALLY_EXPLICIT",threshold:"BLOCK_NONE"},{category:"HARM_CATEGORY_DANGEROUS_CONTENT",threshold:"BLOCK_NONE"}]},r=>{if(r.candidates&&r.candidates[0].content&&r.candidates[0].content.parts){let n=r.candidates[0].content.parts[0].text;s+=n,t&&t(n)}}),s}catch(r){throw u(this.plugin,`Error generating response with model ${i}: ${r}`),new Error(`Failed to generate response: ${r.message}`)}}};v();var Ht=require("obsidian");var tt=class{constructor(a,t){let e=t.settings.microsoftEndpointUrl||"https://api.cognitive.microsoft.com";this.apiHelper=new W(e,{"api-key":a},t),this.plugin=t}async getAvailableModels(){try{let a="/openai/deployments?api-version=2023-03-15-preview";u(this.plugin,`Fetching Microsoft models from: ${a}`);let t=await this.apiHelper.get(a);if(u(this.plugin,"Microsoft API response:",t),t.error)throw new Error(`Azure API Error: ${t.error.code} - ${t.error.message}`);if(t.data&&Array.isArray(t.data))return t.data.filter(e=>e.status==="succeeded"&&e.model&&typeof e.model=="string").map(e=>e.id);throw new Error("Unexpected response format from Microsoft API")}catch(a){throw u(this.plugin,`Error fetching Microsoft models: ${a}`),a}}async generateResponse(a,t){let e=this.plugin.settings.providerModels.microsoft,i=e&&e.length>0?e[0]:"gpt-35-turbo";i||new Ht.Notice('No Microsoft model has been selected. Using default model "gpt-35-turbo".');let s="";try{return await this.apiHelper.postStream(`openai/deployments/${i}/completions?api-version=2023-05-15`,{messages:[{role:"system",content:ce},{role:"user",content:a}],stream:!0},r=>{if(r.choices&&r.choices[0].delta&&r.choices[0].delta.content){let n=r.choices[0].delta.content;s+=n,t&&t(n)}}),s}catch(r){throw u(this.plugin,`Error generating response with model ${i}: ${r}`),new Error(`Failed to generate response: ${r.message}`)}}};v();var Dt=require("obsidian");var it=class{constructor(a,t){this.apiHelper=new W("https://api.anthropic.com/v1",{"x-api-key":a,"anthropic-version":"2023-06-01"},this.plugin),this.plugin=t}async getAvailableModels(){try{let a=await this.apiHelper.post("/models",{});if(a.models&&Array.isArray(a.models))return a.models.filter(t=>t.type==="chat").map(t=>t.id);throw new Error("Unexpected response format from Anthropic API")}catch(a){throw u(this.plugin,`Error fetching Anthropic models: ${a}`),a}}async generateResponse(a,t){let e=this.plugin.settings.providerModels.anthropic,i=e&&e.length>0?e[0]:"claude-2";i||new Dt.Notice('No Anthropic model has been selected. Using default model "claude-2".');let s="";try{return await this.apiHelper.postStream("/messages",{model:i,messages:[{role:"system",content:ce},{role:"user",content:a}],max_tokens:1e3,stream:!0},r=>{var n;if(r.type==="content_block_delta"&&((n=r.delta)!=null&&n.text)){let o=r.delta.text;s+=o,t&&t(o)}}),s}catch(r){throw u(this.plugin,`Error generating response with model ${i}: ${r}`),new Error(`Failed to generate response: ${r.message}`)}}};v();var qt=require("obsidian");var st=class{constructor(a,t){this.apiHelper=new W("https://api.groq.com/openai/v1",{Authorization:`Bearer ${a}`,"Content-Type":"application/json"},this.plugin),this.plugin=t}async getAvailableModels(){try{let a=await this.apiHelper.get("/models");if(a.data&&Array.isArray(a.data))return a.data.map(t=>t.id);throw new Error("Unexpected response format from Groq API")}catch(a){throw u(this.plugin,`Error fetching Groq models: ${a}`),a}}async generateResponse(a,t){let e=this.plugin.settings.providerModels.grocq,i=e&&e.length>0?e[0]:"mixtral-8x7b-32768";i||new qt.Notice('No Groq model has been selected. Using default model "mixtral-8x7b-32768".');try{let s=await this.apiHelper.post("/chat/completions",{model:i,messages:[{role:"system",content:ce},{role:"user",content:a}]});if(s.choices&&s.choices.length>0){let r=s.choices[0].message.content;return t&&t(r),r}else throw new Error("No response content received from Groq API")}catch(s){throw u(this.plugin,`Error generating response with model ${i}: ${s}`),new Error(`Failed to generate response: ${s.message}`)}}};v();var Bt=require("obsidian");v();var rt=require("obsidian");var nt=class{constructor(a,t){this.baseUrl=a,this.plugin=t,this.headers={"Content-Type":"application/json"}}async get(a){let t=`${this.baseUrl}${a}`,e=await(0,rt.requestUrl)({url:t,method:"GET",headers:this.headers});if(e.status!==200)throw new Error(`HTTP error! status: ${e.status}`);return e.json}async post(a,t){let e=`${this.baseUrl}${a}`,i=await(0,rt.requestUrl)({url:e,method:"POST",body:JSON.stringify(t),headers:this.headers});if(i.status!==200)throw new Error(`HTTP error! status: ${i.status}`);return i.json}async postStream(a,t,e){let i=`${this.baseUrl}${a}`,s=await(0,rt.requestUrl)({url:i,method:"POST",body:JSON.stringify(t),headers:this.headers,throw:!1});if(s.status!==200)throw new Error(`HTTP error! status: ${s.status}`);let r=await s.arrayBuffer,n=new ReadableStream({start(l){l.enqueue(new Uint8Array(r)),l.close()}}).getReader(),o=new TextDecoder;try{let l="";for(;;){let{done:p,value:m}=await n.read();if(p)break;l+=o.decode(m,{stream:!0});let w;for(;(w=l.indexOf(`
`))!==-1;){let S=l.slice(0,w);if(l=l.slice(w+1),S.trim())try{let T=JSON.parse(S);e(T)}catch(T){u(this.plugin,`Error parsing JSON: ${T instanceof Error?T.message:String(T)}`)}}}}finally{n.releaseLock()}}};var at=class{constructor(a,t){this.apiHelper=new nt(a,this.plugin),this.plugin=t}async getAvailableModels(){try{let a=await this.apiHelper.get("/api/tags");if(a.models&&Array.isArray(a.models))return a.models.map(t=>t.name);throw new Error("Unexpected response format from Ollama API")}catch(a){throw u(this.plugin,`Error fetching Ollama models: ${a}`),new Error("Failed to fetch Ollama models. Please ensure the Ollama server is running and the URL is correct.")}}async generateResponse(a,t){let e=this.plugin.settings.providerModels.ollama,i=e&&e.length>0?e[0]:"llama2";i||new Bt.Notice('No Ollama model has been selected. Using default model "llama2".');let s="";try{return await this.apiHelper.postStream("/api/generate",{model:i,system:ce,prompt:a,stream:!0},r=>{r.response&&(s+=r.response,t&&t(r.response))}),s}catch(r){throw u(this.plugin,`Error generating response with model ${i}: ${r}`),new Error(`Failed to generate response: ${r.message}`)}}};v();var Ne=require("obsidian");v();function oi(c,a,t,e){function i(s){return s instanceof t?s:new t(function(r){r(s)})}return new(t||(t=Promise))(function(s,r){function n(p){try{l(e.next(p))}catch(m){r(m)}}function o(p){try{l(e.throw(p))}catch(m){r(m)}}function l(p){p.done?s(p.value):i(p.value).then(n,o)}l((e=e.apply(c,a||[])).next())})}var li=/(?:youtube\.com\/(?:[^\/]+\/.+\/|(?:v|e(?:mbed)?)\/|.*[?&]v=)|youtu\.be\/)([^"&?\/\s]{11})/i,Ut="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36,gzip(gfe)",ci=/<text start="([^"]*)" dur="([^"]*)">([^<]*)<\/text>/g,Me=class extends Error{constructor(a){super(`[YoutubeTranscript] \u{1F6A8} ${a}`)}},kt=class extends Me{constructor(){super("YouTube is receiving too many requests from this IP and now requires solving a captcha to continue")}},Tt=class extends Me{constructor(a){super(`The video is no longer available (${a})`)}},ot=class extends Me{constructor(a){super(`Transcript is disabled on this video (${a})`)}},lt=class extends Me{constructor(a){super(`No transcripts are available for this video (${a})`)}},Mt=class extends Me{constructor(a,t,e){super(`No transcripts are available in ${a} this video (${e}). Available languages: ${t.join(", ")}`)}},ct=class{static fetchTranscript(a,t){var e;return oi(this,void 0,void 0,function*(){let i=this.retrieveVideoId(a),r=yield(yield fetch(`https://www.youtube.com/watch?v=${i}`,{headers:Object.assign(Object.assign({},(t==null?void 0:t.lang)&&{"Accept-Language":t.lang}),{"User-Agent":Ut})})).text(),n=r.split('"captions":');if(n.length<=1)throw r.includes('class="g-recaptcha"')?new kt:r.includes('"playabilityStatus":')?new ot(a):new Tt(a);let o=(e=(()=>{try{return JSON.parse(n[1].split(',"videoDetails')[0].replace(`
`,""))}catch(S){return}})())===null||e===void 0?void 0:e.playerCaptionsTracklistRenderer;if(!o)throw new ot(a);if(!("captionTracks"in o))throw new lt(a);if(t!=null&&t.lang&&!o.captionTracks.some(S=>S.languageCode===(t==null?void 0:t.lang)))throw new Mt(t==null?void 0:t.lang,o.captionTracks.map(S=>S.languageCode),a);let l=(t!=null&&t.lang?o.captionTracks.find(S=>S.languageCode===(t==null?void 0:t.lang)):o.captionTracks[0]).baseUrl,p=yield fetch(l,{headers:Object.assign(Object.assign({},(t==null?void 0:t.lang)&&{"Accept-Language":t.lang}),{"User-Agent":Ut})});if(!p.ok)throw new lt(a);return[...(yield p.text()).matchAll(ci)].map(S=>{var T;return{text:S[3],duration:parseFloat(S[2]),offset:parseFloat(S[1]),lang:(T=t==null?void 0:t.lang)!==null&&T!==void 0?T:o.captionTracks[0].languageCode}})})}static retrieveVideoId(a){if(a.length===11)return a;let t=a.match(li);if(t&&t.length)return t[1];throw new Me("Impossible to retrieve Youtube video ID.")}};var Ce=class Ce{constructor(a){this.plugin=a,u(this.plugin,"Initializing YoutubeProvider")}async getTranscript(a){u(this.plugin,`[getTranscript] Attempting to fetch transcript for URL: ${a}`);try{let t=this.extractVideoId(a);if(!t)throw new Error("Invalid YouTube URL, cannot extract video ID");let e=await this.fetchViaYtDlp(t,"en");if((!e||e.length===0)&&(e=await this.fetchViaYtDlp(t)),(!e||e.length===0)&&(e=await this.fetchViaLibraryPatched(t,"en")),(!e||e.length===0)&&(e=await this.fetchViaLibraryPatched(t)),(!e||e.length===0)&&(e=await this.fetchTranscriptViaObsidian(t,"en"),(!e||e.length===0)&&(e=await this.fetchTranscriptViaObsidian(t))),(!e||e.length===0)&&(e=await this.fetchViaTimedTextPreferred(t)),!e||e.length===0){let s=["en","en-US","en-GB"];for(let r of s)if(e=await this.fetchTranscriptViaTimedText(t,r,!1),e&&e.length>0||(e=await this.fetchTranscriptViaTimedText(t,r,!0),e&&e.length>0))break}if(!e||e.length===0)throw new Error("No transcript found for this video");let i=e.map(s=>s.text).join(" ").trim();return u(this.plugin,`[getTranscript] Transcript fetched successfully. Length: ${i.length}`),i}catch(t){throw u(this.plugin,`[getTranscript] Error fetching YouTube transcript: ${t}`),t}}async fetchTranscriptViaObsidian(a,t){let e=`https://www.youtube.com/watch?v=${a}`,i={"User-Agent":Ce.USER_AGENT};t&&(i["Accept-Language"]=t);let r=(await(0,Ne.requestUrl)({url:e,headers:i})).text,n=r.split('"captions":');if(n.length<=1)throw r.includes('class="g-recaptcha"')?new Error("Rate limited by YouTube while fetching transcript"):r.includes('"playabilityStatus":')?new Error("Transcripts are disabled for this video"):new Error("This video is unavailable");let o;try{let S=n[1].split(',"videoDetails')[0].replace(`
`,"");o=JSON.parse(S).playerCaptionsTracklistRenderer}catch(S){throw new Error("Failed to parse captions data from YouTube")}if(!o)throw new Error("Transcripts are disabled for this video");if(!("captionTracks"in o))throw new Error("No transcript available for this video");let l=o.captionTracks,p=l[0];t&&l.some(S=>S.languageCode===t)&&(p=l.find(S=>S.languageCode===t));let w=(await(0,Ne.requestUrl)({url:p.baseUrl,headers:i})).text;return this.parseTranscriptXml(w,p.languageCode)}extractVideoId(a){let t=/(?:https?:\/\/)?(?:www\.)?(?:youtube\.com\/(?:[^\/\n\s]+\/\S+\/|(?:v|e(?:mbed)?)\/|\S*?[?&]v=)|youtu\.be\/)([a-zA-Z0-9_-]{11})/,e=a.match(t);return e?e[1]:null}parseTranscriptXml(a,t){let e=[];try{let r=new DOMParser().parseFromString(a,"text/xml").getElementsByTagName("text");for(let n=0;n<r.length;n++){let o=r.item(n),l=parseFloat(o.getAttribute("start")||"0"),p=parseFloat(o.getAttribute("dur")||"0"),m=(o.textContent||"").trim();e.push({text:m,duration:p,offset:l,lang:t})}}catch(i){let s=/<text start=\"([^\"]*)\" dur=\"([^\"]*)\">([\s\S]*?)<\/text>/g,r;for(;(r=s.exec(a))!==null;)e.push({text:r[3],duration:parseFloat(r[2]),offset:parseFloat(r[1]),lang:t})}return e}async fetchTranscriptViaTimedText(a,t,e){let i=new URLSearchParams({v:a,lang:t});e&&i.set("kind","asr");let s=`https://video.google.com/timedtext?${i.toString()}`,r={"User-Agent":Ce.USER_AGENT,"Accept-Language":t},o=(await(0,Ne.requestUrl)({url:s,headers:r})).text||"";return!o.includes("<transcript")&&!o.includes("<text")?[]:this.parseTranscriptXml(o,t)}async fetchViaLibraryPatched(a,t){let e=globalThis.fetch;try{globalThis.fetch=async(s,r)=>{let n=typeof s=="string"?s:s.url,o={"User-Agent":Ce.USER_AGENT};if(r&&r.headers){let p=r.headers;if(Array.isArray(p))for(let[m,w]of p)o[m]=w;else p&&typeof p=="object"&&Object.assign(o,p)}let l=await(0,Ne.requestUrl)({url:n,method:(r==null?void 0:r.method)||"GET",headers:o,body:r==null?void 0:r.body});return{ok:l.status>=200&&l.status<300,status:l.status,async text(){return l.text}}};let i=await ct.fetchTranscript(a,t?{lang:t}:void 0);return!i||i.length===0?[]:i.map(s=>({text:s.text,duration:s.duration,offset:s.offset,lang:t}))}catch(i){return[]}finally{globalThis.fetch=e}}async fetchViaYtDlp(a,t){try{let e=window.require?window.require("child_process"):void 0;if(!e)return[];let i=window.require("path"),s=window.require("os"),r=window.require("fs"),o=[this.plugin.settings.youtubeYtDlpPath,"yt-dlp","/opt/homebrew/bin/yt-dlp","/usr/local/bin/yt-dlp","/usr/bin/yt-dlp"].filter(Boolean),l;for(let O of o)try{e.execFileSync(O,["--version"],{stdio:"ignore"}),l=O;break}catch(H){}if(!l)return[];let p=["--write-auto-subs","--skip-download","--sub-format","vtt","--quiet","--no-warnings"];if(t){let O=t.length>2?t.slice(0,2):t,H=`${t},${O}.*,${O}`;p.push("--sub-langs",H)}let m=`https://www.youtube.com/watch?v=${a}`,w=s.tmpdir(),S=i.join(w,`mesh-ytdlp-${a}-%(title)s.%(ext)s`);p.push("-o",S),p.push(m),e.execFileSync(l,p,{stdio:"ignore"});let T=r.readdirSync(w).filter(O=>O.includes(`mesh-ytdlp-${a}`)&&O.toLowerCase().endsWith(".vtt")).map(O=>i.join(w,O));if(T.length===0)return[];let F=r.readFileSync(T[0],"utf8").split(/\r?\n/),V=[],ie=0;for(let O of F){let H=O.trim();if(!H||H==="WEBVTT"||H.startsWith("NOTE")||H.includes("-->")){if(H.includes("-->")){let L=H.split(" --> ");if(L[0]){let z=L[0].split(".")[0].split(":").map(Y=>parseInt(Y,10)||0);ie=z.length===3?z[0]*3600+z[1]*60+z[2]:z[0]*60+z[1]}}continue}let X=H.replace(/<[^>]*>/g,"");X&&V.push({text:X,duration:0,offset:ie,lang:t})}for(let O of T)try{r.unlinkSync(O)}catch(H){}return V}catch(e){return[]}}async fetchViaTimedTextPreferred(a){let t=await this.listTimedTextTracks(a);if(!t||t.length===0)return[];let e=o=>o==="en"||o==="en-US"||o==="en-GB",i=t.filter(o=>o.kind!=="asr"),s=t.filter(o=>o.kind==="asr"),r=i.find(o=>e(o.lang_code))||s.find(o=>e(o.lang_code))||i[0]||s[0];if(!r)return[];let n=await this.fetchTimedTextByTrack(a,r);if((!n||n.length===0)&&e(r.lang_code))return[];if(!e(r.lang_code)){let o=await this.fetchTimedTextByTrack(a,r,"en");if(o&&o.length>0)return o}return n||[]}async listTimedTextTracks(a){let t=`https://video.google.com/timedtext?type=list&v=${encodeURIComponent(a)}`,e={"User-Agent":Ce.USER_AGENT},s=(await(0,Ne.requestUrl)({url:t,headers:e})).text||"";if(!s.includes("<transcript_list"))return[];let n=new DOMParser().parseFromString(s,"text/xml");return Array.from(n.getElementsByTagName("track")).map(l=>({lang_code:l.getAttribute("lang_code")||"",name:l.getAttribute("name")||void 0,vss_id:l.getAttribute("vss_id")||void 0,kind:l.getAttribute("kind")||void 0})).filter(l=>l.lang_code)}async fetchTimedTextByTrack(a,t,e){let i=new URLSearchParams({v:a,lang:t.lang_code});t.kind==="asr"&&i.set("kind","asr"),t.name&&i.set("name",t.name),e&&i.set("tlang",e);let s=`https://video.google.com/timedtext?${i.toString()}`,r={"User-Agent":Ce.USER_AGENT},o=(await(0,Ne.requestUrl)({url:s,headers:r})).text||"";return!o.includes("<transcript")&&!o.includes("<text")?[]:this.parseTranscriptXml(o,e||t.lang_code)}};Ce.USER_AGENT="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_4) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/85.0.4183.83 Safari/537.36,gzip(gfe)";var pt=Ce;v();var $e=class{constructor(a,t){this.apiHelper=new W("https://api.tavily.com",{"Content-Type":"application/json"},this.plugin),this.plugin=t,this.apiKey=a}async search(a){try{let t=await this.apiHelper.post("/search",{api_key:this.apiKey,query:a,search_depth:"advanced",include_answer:!0,include_images:!0,include_raw_content:!1,max_results:10});if(t)return JSON.stringify(t);throw new Error("No results found in Tavily response")}catch(t){throw u(this.plugin,`Error fetching results from Tavily: ${t}`),t.response&&(u(this.plugin,`Response status: ${t.response.status}`),u(this.plugin,`Response data: ${JSON.stringify(t.response.data)}`)),new Error(`Failed to fetch results from Tavily: ${t.message}`)}}};v();var ve=require("obsidian");var dt=class extends ve.Modal{constructor(t,e){super(t);this.selectedPatterns=[];this.currentSelectedIndex=-1;this.patternResultElements=[];this.plugin=e}onOpen(){let{contentEl:t}=this;t.empty(),this.contentEl.addClass("mesh-modal"),this.loadingOverlay=t.createEl("div",{cls:"mesh-loading-overlay"}),this.loadingOverlay.createEl("div",{cls:"mesh-loading-spinner"}),this.loadingOverlay.style.display="none";let e={openai:"openai",google:"google",microsoft:"microsoft",anthropic:"anthropic",grocq:"grocq",ollama:"ollama",openrouter:"openrouter",lmstudio:"lmstudio"};new ve.Setting(t).setName("Provider").setDesc("Select the AI provider").addDropdown(r=>(Object.values(e).forEach(n=>{(n==="ollama"?this.plugin.settings.ollamaServerUrl:this.plugin.settings[`${n}ApiKey`])&&r.addOption(n,n)}),r.setValue(this.plugin.settings.selectedProvider),r.onChange(n=>{this.plugin.settings.selectedProvider=n,this.plugin.saveSettings()}),this.providerSelect=r,r));let i=t.createEl("div",{cls:"pattern-card"}),s=i.createEl("div",{cls:"pattern-search-container"});this.patternInput=new ve.TextComponent(s).setPlaceholder("Search patterns...").onChange(r=>{Te(this.plugin,r,this.patternResults,n=>{Pe(n,this.selectedPatterns,()=>ye(this.selectedPatternsTitle,this.selectedPatternsContainer,this.selectedPatterns,o=>{this.selectedPatterns=o}),()=>this.patternInput.setValue(""),()=>this.patternResults.empty())},n=>{this.patternResultElements=n,this.currentSelectedIndex=n.length>0?0:-1,this.highlightCurrentResult()})}),this.patternInput.inputEl.addEventListener("keydown",this.handlePatternInputKeydown.bind(this)),this.patternResults=s.createEl("div",{cls:"pattern-results"}),this.selectedPatternsTitle=i.createEl("h4",{text:"Selected Patterns",cls:"mesh-selected-patterns-title"}),this.selectedPatternsContainer=i.createEl("div",{cls:"selected-patterns-container"}),new ve.Setting(t).setName("Output File Name").setDesc("Enter a name for the output file (optional)").addText(r=>{this.outputFileNameInput=r.inputEl,r.setPlaceholder("Output file name")}),new ve.Setting(t).addButton(r=>r.setButtonText("Process").onClick(()=>this.processActiveNote()))}async processActiveNote(){let t=this.app.workspace.getActiveFile();if(!t){new ve.Notice("No active file");return}let e=await this.app.vault.read(t),i=this.outputFileNameInput;try{this.showLoading();let s;this.plugin.settings.patternStitchingEnabled?s=await de(this.plugin,this.plugin.settings.selectedProvider,this.selectedPatterns,e):s=await pe(this.plugin,this.plugin.settings.selectedProvider,this.selectedPatterns,e),await fe(this.plugin,s,i),this.close(),new ve.Notice("Active note processed successfully")}catch(s){console.error("Error processing active note:",s),new ve.Notice(`Error: ${s instanceof Error?s.message:String(s)}`)}finally{this.hideLoading()}}showLoading(){this.loadingOverlay.style.display="flex"}hideLoading(){this.loadingOverlay.style.display="none"}onClose(){let{contentEl:t}=this;t.empty()}handlePatternInputKeydown(t){(t.key==="ArrowDown"||t.key==="ArrowUp"||t.key==="Enter")&&(t.preventDefault(),t.key==="ArrowDown"?this.navigatePatternResults(1):t.key==="ArrowUp"?this.navigatePatternResults(-1):t.key==="Enter"&&this.selectCurrentPattern())}navigatePatternResults(t){let e=this.patternResultElements.length;e!==0&&(this.currentSelectedIndex=(this.currentSelectedIndex+t+e)%e,this.highlightCurrentResult())}highlightCurrentResult(){this.patternResultElements.forEach((t,e)=>{t.classList.toggle("selected",e===this.currentSelectedIndex)})}selectCurrentPattern(){var t;if(this.currentSelectedIndex>=0&&this.currentSelectedIndex<this.patternResultElements.length){let i=((t=this.patternResultElements[this.currentSelectedIndex].textContent)==null?void 0:t.trim())||"";this.handlePatternSelect(i)}}handlePatternSelect(t){Pe(t,this.selectedPatterns,()=>ye(this.containerEl.querySelector(".mesh-selected-patterns-title"),this.selectedPatternsContainer,this.selectedPatterns,e=>{this.selectedPatterns=e}),()=>this.patternInput.setValue(""),()=>{this.patternResults.empty(),this.patternResultElements=[],this.currentSelectedIndex=-1})}};v();var ne=require("obsidian");var Be=class extends ne.Modal{constructor(t,e){super(t);this.selectedPatterns=[];this.currentSelectedIndex=-1;this.patternResultElements=[];this.plugin=e}onOpen(){let{contentEl:t}=this;t.empty(),this.contentEl.addClass("mesh-modal"),this.loadingOverlay=t.createEl("div",{cls:"mesh-loading-overlay"}),this.loadingOverlay.createEl("div",{cls:"mesh-loading-spinner"}),this.loadingOverlay.style.display="none";let e={openai:"openai",google:"google",microsoft:"microsoft",anthropic:"anthropic",grocq:"grocq",ollama:"ollama",openrouter:"openrouter",lmstudio:"lmstudio"};new ne.Setting(t).setName("Provider").setDesc("Select the AI provider").addDropdown(r=>(Object.values(e).forEach(n=>{(n==="ollama"?this.plugin.settings.ollamaServerUrl:this.plugin.settings[`${n}ApiKey`])&&r.addOption(n,n)}),r.setValue(this.plugin.settings.selectedProvider),r.onChange(n=>{this.plugin.settings.selectedProvider=n,this.plugin.saveSettings()}),this.providerSelect=r,r)),new ne.Setting(t).setName("Clipboard Content").setDesc("Preview of clipboard content (read-only)").addTextArea(r=>{this.clipboardPreview=r.inputEl,r.setPlaceholder("Clipboard content will appear here"),r.inputEl.rows=5,r.inputEl.cols=50,r.inputEl.readOnly=!0}),new ne.Setting(t).addButton(r=>r.setButtonText("Refresh clipboard").onClick(()=>this.refreshClipboardContent()));let i=t.createEl("div",{cls:"pattern-card"}),s=i.createEl("div",{cls:"pattern-search-container"});this.patternInput=new ne.TextComponent(s).setPlaceholder("Search patterns...").onChange(r=>{Te(this.plugin,r,this.patternResults,n=>{Pe(n,this.selectedPatterns,()=>ye(this.selectedPatternsTitle,this.selectedPatternsContainer,this.selectedPatterns,o=>{this.selectedPatterns=o}),()=>this.patternInput.setValue(""),()=>this.patternResults.empty())},n=>{this.patternResultElements=n,this.currentSelectedIndex=n.length>0?0:-1,this.highlightCurrentResult()})}),this.patternInput.inputEl.addEventListener("keydown",this.handlePatternInputKeydown.bind(this)),this.patternResults=s.createEl("div",{cls:"pattern-results"}),this.selectedPatternsTitle=i.createEl("h4",{text:"Selected Patterns",cls:"mesh-selected-patterns-title"}),this.selectedPatternsContainer=i.createEl("div",{cls:"selected-patterns-container"}),new ne.Setting(t).setName("Output File Name").setDesc("Enter a name for the output file (optional)").addText(r=>{this.outputFileNameInput=r.inputEl,r.setPlaceholder("Output file name")}),new ne.Setting(t).addButton(r=>r.setButtonText("New note").onClick(()=>this.processClipboard())).addButton(r=>r.setButtonText("In place").onClick(()=>this.processClipboard(!0))),this.refreshClipboardContent()}async refreshClipboardContent(){try{let t=await navigator.clipboard.readText();this.clipboardPreview.value=t}catch(t){console.error("Failed to read clipboard contents:",t),new ne.Notice("Failed to read clipboard contents. Please ensure you have given the necessary permissions.")}}async processClipboard(t=!1){let e=this.clipboardPreview.value;if(!e){new ne.Notice("No clipboard content");return}let i=this.outputFileNameInput;try{this.showLoading();let s;this.plugin.settings.patternStitchingEnabled?s=await de(this.plugin,this.plugin.settings.selectedProvider,this.selectedPatterns,e):s=await pe(this.plugin,this.plugin.settings.selectedProvider,this.selectedPatterns,e),t?await Ye(this.plugin,s):await fe(this.plugin,s,i),this.close(),new ne.Notice("Clipboard content processed successfully")}catch(s){console.error("Error processing clipboard content:",s),new ne.Notice(`Error: ${s instanceof Error?s.message:String(s)}`)}finally{this.hideLoading()}}showLoading(){this.loadingOverlay.style.display="flex"}hideLoading(){this.loadingOverlay.style.display="none"}onClose(){let{contentEl:t}=this;t.empty()}handlePatternInputKeydown(t){(t.key==="ArrowDown"||t.key==="ArrowUp"||t.key==="Enter")&&(t.preventDefault(),t.key==="ArrowDown"?this.navigatePatternResults(1):t.key==="ArrowUp"?this.navigatePatternResults(-1):t.key==="Enter"&&this.selectCurrentPattern())}navigatePatternResults(t){let e=this.patternResultElements.length;e!==0&&(this.currentSelectedIndex=(this.currentSelectedIndex+t+e)%e,this.highlightCurrentResult())}highlightCurrentResult(){this.patternResultElements.forEach((t,e)=>{t.classList.toggle("selected",e===this.currentSelectedIndex)})}selectCurrentPattern(){var t;if(this.currentSelectedIndex>=0&&this.currentSelectedIndex<this.patternResultElements.length){let i=((t=this.patternResultElements[this.currentSelectedIndex].textContent)==null?void 0:t.trim())||"";this.handlePatternSelect(i)}}handlePatternSelect(t){Pe(t,this.selectedPatterns,()=>ye(this.containerEl.querySelector(".mesh-selected-patterns-title"),this.selectedPatternsContainer,this.selectedPatterns,e=>{this.selectedPatterns=e}),()=>this.patternInput.setValue(""),()=>{this.patternResults.empty(),this.patternResultElements=[],this.currentSelectedIndex=-1})}};v();var ge=require("obsidian");var ut=class extends ge.Modal{constructor(t,e){super(t);this.selectedPatterns=[];this.currentSelectedIndex=-1;this.patternResultElements=[];this.plugin=e}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("mesh-modal"),this.loadingOverlay=t.createEl("div",{cls:"mesh-loading-overlay"}),this.loadingOverlay.createEl("div",{cls:"mesh-loading-spinner"}),this.loadingOverlay.style.display="none";let e={openai:"openai",google:"google",microsoft:"microsoft",anthropic:"anthropic",grocq:"grocq",ollama:"ollama",openrouter:"openrouter",lmstudio:"lmstudio"};new ge.Setting(t).setName("Provider").setDesc("Select the AI provider").addDropdown(r=>(Object.values(e).forEach(n=>{(n==="ollama"?this.plugin.settings.ollamaServerUrl:this.plugin.settings[`${n}ApiKey`])&&r.addOption(n,n)}),r.setValue(this.plugin.settings.selectedProvider),r.onChange(n=>{this.plugin.settings.selectedProvider=n,this.plugin.saveSettings()}),this.providerSelect=r,r)),new ge.Setting(t).setName("Tavily Search").setDesc("Enter your search query").addText(r=>{this.searchInput=r.inputEl,r.setPlaceholder("Enter search query")});let i=t.createEl("div",{cls:"pattern-card"}),s=i.createEl("div",{cls:"pattern-search-container"});this.patternInput=new ge.TextComponent(s).setPlaceholder("Search patterns...").onChange(r=>{Te(this.plugin,r,this.patternResults,this.handlePatternSelect.bind(this),n=>{this.patternResultElements=n,this.currentSelectedIndex=n.length>0?0:-1,this.highlightCurrentResult()})}),this.patternInput.inputEl.addEventListener("keydown",this.handleKeyDown.bind(this)),this.patternResults=s.createEl("div",{cls:"pattern-results"}),this.selectedPatternsTitle=i.createEl("h4",{text:"Selected Patterns",cls:"mesh-selected-patterns-title"}),this.selectedPatternsContainer=i.createEl("div",{cls:"selected-patterns-container"}),new ge.Setting(t).setName("Output File Name").setDesc("Enter a name for the output file (optional)").addText(r=>{this.outputFileNameInput=r.inputEl,r.setPlaceholder("Output file name")}),new ge.Setting(t).addButton(r=>r.setButtonText("New note").onClick(()=>this.processSearch())).addButton(r=>r.setButtonText("In place").onClick(()=>this.processSearch(!0)))}async processSearch(t=!1){if(!this.searchInput.value){new ge.Notice("Please enter a search query");return}try{this.showLoading();let e=await this.plugin.tavilyProvider.search(this.searchInput.value),i;this.plugin.settings.patternStitchingEnabled?i=await de(this.plugin,this.plugin.settings.selectedProvider,this.selectedPatterns,e):i=await pe(this.plugin,this.plugin.settings.selectedProvider,this.selectedPatterns,e),t?await Ye(this.plugin,i):await fe(this.plugin,i,this.outputFileNameInput.value),this.close(),new ge.Notice("Search processed successfully")}catch(e){console.error("Error processing search:",e),new ge.Notice(`Error: ${e instanceof Error?e.message:String(e)}`)}finally{this.hideLoading()}}showLoading(){this.loadingOverlay.style.display="flex"}hideLoading(){this.loadingOverlay.style.display="none"}onClose(){let{contentEl:t}=this;t.empty()}handlePatternSelect(t){Pe(t,this.selectedPatterns,()=>ye(this.selectedPatternsTitle,this.selectedPatternsContainer,this.selectedPatterns,e=>{this.selectedPatterns=e}),()=>this.patternInput.setValue(""),()=>{this.patternResults.empty(),this.patternResultElements=[],this.currentSelectedIndex=-1})}handleKeyDown(t){if(this.patternResultElements.length!==0)switch(t.key){case"ArrowDown":t.preventDefault(),this.currentSelectedIndex=(this.currentSelectedIndex+1)%this.patternResultElements.length,this.highlightCurrentResult();break;case"ArrowUp":t.preventDefault(),this.currentSelectedIndex=(this.currentSelectedIndex-1+this.patternResultElements.length)%this.patternResultElements.length,this.highlightCurrentResult();break;case"Enter":if(t.preventDefault(),this.currentSelectedIndex!==-1){let e=this.patternResultElements[this.currentSelectedIndex].textContent;e&&this.handlePatternSelect(e)}break}}highlightCurrentResult(){this.patternResultElements.forEach((t,e)=>{t.classList.toggle("selected",e===this.currentSelectedIndex)}),this.currentSelectedIndex!==-1&&this.patternResultElements[this.currentSelectedIndex].scrollIntoView({block:"nearest",inline:"nearest"})}};v();var Fe=require("obsidian");v();async function zt(c,a,t){return a.usePatternStitching==!0?await de(c,a.provider,a.patterns,t):await pe(c,a.provider,a.patterns,t)}var ht=class extends Fe.Modal{constructor(t,e,i){super(t);this.searchQuery="";this.plugin=e,this.workflow=i,this.tavilyProvider=new $e(this.plugin.settings.tavilyApiKey,this.plugin)}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("mesh-modal-tavily"),this.loadingOverlay=t.createEl("div",{cls:"mesh-loading-overlay"}),this.loadingOverlay.createEl("div",{cls:"mesh-loading-spinner"}),this.loadingOverlay.style.display="none",t.createEl("h2",{text:"Tavily Search",cls:"mesh-modal-tavily-title"});let e=t.createEl("div",{cls:"mesh-modal-tavily-search-container"});e.createEl("input",{type:"text",placeholder:"Enter your search query",cls:"mesh-tavily-input"}).addEventListener("input",r=>this.searchQuery=r.target.value),e.createEl("span",{text:"\u{1F50D}",cls:"mesh-modal-tavily-search-icon"}),t.createEl("button",{text:"Run Workflow",cls:"mesh-modal-tavily-button"}).addEventListener("click",()=>this.runWorkflow())}async runWorkflow(){if(!this.searchQuery){new Fe.Notice("Please enter a search query");return}try{this.showLoading();let t=await this.tavilyProvider.search(this.searchQuery),e=await zt(this.plugin,this.workflow,t),i=`Workflow Output ${new Date().toISOString().replace(/:/g,"-")}`;await fe(this.plugin,e,i),new Fe.Notice("Workflow processed successfully"),this.close()}catch(t){console.error("Error processing workflow:",t),new Fe.Notice(`Error: ${t instanceof Error?t.message:String(t)}`)}finally{this.hideLoading()}}showLoading(){this.loadingOverlay.style.display="flex"}hideLoading(){this.loadingOverlay.style.display="none"}onClose(){let{contentEl:t}=this;t.empty()}};v();var gt=class{constructor(a,t){this.apiHelper=new W("https://api.perplexity.ai",{accept:"application/json","Content-Type":"application/json",Authorization:`Bearer ${a}`},t),this.plugin=t,this.apiKey=a}async search(a){try{let t=await this.apiHelper.post("/chat/completions",{model:"llama-3.1-sonar-large-128k-online",messages:[{role:"system",content:"Be precise and concise."},{role:"user",content:a}],return_images:!0});if(t&&t.choices&&t.choices.length>0)return t.choices[0].message.content;throw new Error("No results found in Perplexity response")}catch(t){throw u(this.plugin,`Error fetching results from Perplexity: ${t}`),t.response&&(u(this.plugin,`Response status: ${t.response.status}`),u(this.plugin,`Response data: ${JSON.stringify(t.response.data)}`)),new Error(`Failed to fetch results from Perplexity: ${t.message}`)}}};v();var mt=class{constructor(a,t){this.apiHelper=new W("https://openrouter.ai/api/v1",{Authorization:`Bearer ${a}`,"Content-Type":"application/json","HTTP-Referer":"https://github.com/chasebank87/mesh-ai","X-Title":"Mesh AI Plugin for Obsidian"},t),this.plugin=t}async generateResponse(a,t){let i=a.includes(Ge)?this.plugin.settings.pathwaysModel:this.plugin.settings.providerModels.openrouter[0]||"openai/gpt-3.5-turbo",s=[];try{let n=await this.getAvailableModels(),o=[i,"openai/gpt-4o-mini","openai/gpt-4.1-mini","openai/gpt-4o","openai/gpt-4.1","anthropic/claude-3.5-sonnet","anthropic/claude-3-haiku","deepseek/deepseek-r1","deepseek/deepseek-v3","deepseek/deepseek-chat","google/gemini-1.5-flash","google/gemini-1.5-pro","mistralai/mistral-small","cohere/command-r"].filter(Boolean),l=new Set;for(let p of o){if(!p)continue;if(n.includes(p)){l.add(p);continue}let m=n.find(w=>w.toLowerCase().includes(p.toLowerCase()));m&&l.add(m)}if(l.size===0){for(let p of n)if(/(mini|small|flash)/i.test(p)&&(l.add(p),l.size>=3))break}s=Array.from(l)}catch(n){s=[i,"openai/gpt-4o-mini","anthropic/claude-3.5-sonnet","google/gemini-1.5-flash","mistralai/mistral-small","cohere/command-r"].filter((o,l,p)=>!!o&&p.indexOf(o)===l)}let r=null;for(let n of s){u(this.plugin,`Using OpenRouter model: ${n}`);let o="/chat/completions",l={model:n,messages:[{role:"system",content:ce},{role:"user",content:a}],stream:!!t};try{if(t){let p="";return await this.apiHelper.postStream(o,l,m=>{if(m.choices&&m.choices[0].delta&&m.choices[0].delta.content){let w=m.choices[0].delta.content;p+=w,t(w)}}),p.trim()}else{let p=await this.apiHelper.post(o,l);if(p.choices&&p.choices[0]&&p.choices[0].message)return p.choices[0].message.content.trim();throw new Error("Unexpected response format from OpenRouter API")}}catch(p){r=p;let m=typeof(p==null?void 0:p.message)=="string"?p.message:String(p);if(u(this.plugin,`Error generating response with model ${n}: ${m}`),!(/\b404\b/.test(m)||/model not found|unknown model|unavailable/i.test(m)))break}}throw new Error(`Failed to generate response: ${(r==null?void 0:r.message)||r||"Unknown error"}`)}async getAvailableModels(){try{let a=await this.apiHelper.get("/models");if(a.data&&Array.isArray(a.data))return a.data.map(t=>t.id);throw new Error("Unexpected response format from OpenRouter API")}catch(a){throw u(this.plugin,`Error fetching OpenRouter models: ${a}`),a}}};v();var Vt=require("obsidian");var ft=class{constructor(a,t){this.plugin=t,this.apiHelper=new W(a,{"Content-Type":"application/json"},t)}async getAvailableModels(){try{let a=await this.apiHelper.get("/v1/models");if(a.data&&Array.isArray(a.data))return a.data.map(t=>t.id);throw new Error("Unexpected response format from LMStudio API")}catch(a){throw u(this.plugin,`Error fetching LMStudio models: ${a}`),a}}async generateResponse(a,t){let e=this.plugin.settings.providerModels.lmstudio,i=e&&e.length>0?e[0]:"default-model";i||new Vt.Notice("No LMStudio model has been selected. Using default model.");try{let s=await this.apiHelper.post("/v1/chat/completions",{model:i,messages:[{role:"system",content:ce},{role:"user",content:a}],stream:!1});if(s.choices&&s.choices.length>0){let r=s.choices[0].message.content;return t&&t(r),r}else throw new Error("No response content received from LMStudio API")}catch(s){throw u(this.plugin,`Error generating response with model ${i}: ${s}`),new Error(`Failed to generate response: ${s.message}`)}}};v();var J=require("obsidian");v();var Kt=`
            <p>Below are potential topics, ideas, or events to enhance your vault:</p>
            <ul>
                <li><strong>Link</strong>: Creates a backlink to an existing file.</li>
                <li><strong>Create</strong>: Generates a new note and backlink using your chosen workflow.</li>
            </ul>
`;var vt=class extends J.Modal{constructor(t,e,i){super(t);this.plugin=e,this.content=i,this.pathways=[]}onOpen(){let{contentEl:t}=this;t.empty(),t.addClass("mesh-analyze-pathways-modal"),t.createEl("h2",{text:"Analyze Pathways",cls:"modal-header"});let e=t.createEl("p",{text:"Warning: Using o1 models can be expensive. Check the pricing from OpenRouter before continuing.",cls:"mesh-warning-message"});this.loadingOverlay=t.createEl("div",{cls:"mesh-analyze-pathways-loading-overlay"}),this.loadingOverlay.createEl("div",{cls:"mesh-analyze-pathways-loading-spinner"}),this.loadingOverlay.addClass("hidden"),new J.Setting(t).setName("Confirm Analysis").setDesc("Click to analyze the current document and suggest pathways.").addButton(i=>i.setButtonText("Analyze").onClick(()=>this.analyzePathways()))}async analyzePathways(){this.showLoading(),u(this.plugin,"Starting analyzePathways");try{let t=this.plugin.getProvider("openrouter");u(this.plugin,"Using provider: openrouter");let e=await this.getAllFiles(),i=this.content+`

<files>
`+e+`
</files>`,s=await t.generateResponse(Ge+`

Input:
`+i);u(this.plugin,"Received response from provider"),u(this.plugin,`Response: ${s}`);let r=s.replace(/[\n\r\t]/g,"").replace(/\s+/g," ");this.pathways=JSON.parse(r),u(this.plugin,`Parsed pathways: ${JSON.stringify(this.pathways)}`),this.displayPathways()}catch(t){u(this.plugin,`Error in analyzePathways: ${t.message}`),new J.Notice(`Error analyzing pathways: ${t.message}`),console.error(t)}finally{this.hideLoading()}}async getAllFiles(){return this.app.vault.getFiles().map(e=>e.name).join(`
`)}displayPathways(){let{contentEl:t}=this;t.empty(),t.createEl("h2",{text:"Suggested Pathways",cls:"modal-header"});let e=t.createEl("div",{cls:"mesh-instructions"});e.innerHTML=Kt;let i=t.createEl("div",{cls:"pathway-list"});this.pathways.forEach((n,o)=>{let l=i.createEl("div",{cls:"pathway-item"}),p=l.createEl("div",{cls:"pathway-header"});p.createEl("span",{text:n.backlink,cls:"pathway-backlink"});let m=p.createEl("div",{cls:"button-container"}),w=m.createEl("button",{text:"Create",cls:"create-pathway-button"});w.onclick=()=>this.createPathway(n,l);let S=m.createEl("button",{text:"Delete",cls:"delete-pathway-button hidden"});if(S.onclick=()=>this.deletePathway(n,l),n["potential links"]&&n["potential links"].length>0){let T=l.createEl("h4",{text:"Found Links:",cls:"potential-links-header"}),k=l.createEl("ul",{cls:"potential-links-list"});n["potential links"].forEach(F=>{let V=k.createEl("li",{cls:"potential-link-item"});V.createEl("span",{text:F,cls:"potential-link-text"});let ie=V.createEl("button",{text:"Link",cls:"link-button"});ie.onclick=()=>this.createPotentialLink(n,F,V);let O=V.createEl("button",{text:"Delete",cls:"delete-link-button hidden"});O.onclick=()=>this.deletePotentialLink(F,V)})}});let s=t.createEl("button",{text:"Create All",cls:"create-all-button"});s.onclick=()=>this.createAllPathways();let r=t.createEl("div",{cls:"scroll-indicator"});r.innerHTML='<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevrons-down"><polyline points="7 13 12 18 17 13"></polyline><polyline points="7 6 12 11 17 6"></polyline></svg>'}async createPathway(t,e){e?this.showItemLoading(e):this.showLoading(),u(this.plugin,`Starting createPathway for ${t.backlink}`);let{backlink:i,content:s,match:r}=t,o=`${this.plugin.settings.pathwaysOutputFolder}/${i}.md`;try{let l=this.plugin.settings.defaultPathwayWorkflow,p=this.plugin.settings.workflows.find(k=>k.name===l);if(!p)throw new Error("No default pathway workflow selected");let w=await(this.plugin.settings.pathwaysSearchProvider==="tavily"?this.plugin.tavilyProvider:this.plugin.perplexityProvider).search(s),S;p.usePatternStitching?S=await de(this.plugin,p.provider,p.patterns,w):S=await pe(this.plugin,p.provider,p.patterns,w),await this.app.vault.create(o,S),u(this.plugin,`Created file: ${o}`);let T=this.app.workspace.getActiveViewOfType(J.MarkdownView);if(T){let k=T.editor,V=k.getValue().indexOf(r)+r.length;k.replaceRange(` [[${i}]]`,k.offsetToPos(V)),u(this.plugin,`Inserted backlink: [[${i}]]`)}else u(this.plugin,"No active view found for inserting backlink");if(e){let k=e.querySelector(".create-pathway-button"),F=e.querySelector(".delete-pathway-button");k&&k.addClass("hidden"),F&&F.removeClass("hidden")}new J.Notice(`Pathway created: ${i}`)}catch(l){u(this.plugin,`Error in createPathway: ${l.message}`),new J.Notice(`Error creating pathway: ${l.message}`),console.error(l)}finally{e?this.hideItemLoading(e):this.hideLoading()}}async createPotentialLink(t,e,i){this.showItemLoading(i);try{let s=this.app.workspace.getActiveViewOfType(J.MarkdownView);if(s){let o=s.editor,p=o.getValue().length;o.replaceRange(`
[[${e}]]`,o.offsetToPos(p)),u(this.plugin,`Created potential link: [[${e}]]`)}let r=i.querySelector(".link-button");r&&r.remove();let n=i.querySelector(".delete-link-button");if(n)n.removeClass("hidden");else{let o=i.createEl("button",{text:"Delete",cls:"delete-link-button"});o.onclick=()=>this.deletePotentialLink(e,i)}new J.Notice(`Potential link created: ${e}`)}catch(s){u(this.plugin,`Error in createPotentialLink: ${s.message}`),new J.Notice(`Error creating potential link: ${s.message}`),console.error(s)}finally{this.hideItemLoading(i)}}async createAllPathways(){this.showLoading();for(let t of this.pathways)await this.createPathway(t);this.hideLoading(),this.close()}showLoading(){this.loadingOverlay.removeClass("hidden")}hideLoading(){this.loadingOverlay.addClass("hidden")}showItemLoading(t){t.createEl("div",{cls:"mesh-analyze-pathways-loading-overlay"}).createEl("div",{cls:"mesh-analyze-pathways-loading-spinner"})}hideItemLoading(t){let e=t.querySelector(".mesh-analyze-pathways-loading-overlay");e&&e.remove()}onClose(){let{contentEl:t}=this;t.empty()}async deletePotentialLink(t,e){try{let i=this.app.workspace.getActiveViewOfType(J.MarkdownView);if(i){let n=i.editor,o=n.getValue(),l=new RegExp(`\\[\\[${t}\\]\\]`,"g"),p=o.replace(l,"");n.setValue(p),u(this.plugin,`Deleted potential link: [[${t}]]`)}let s=e.querySelector(".delete-link-button");s&&s.remove();let r=e.querySelector(".link-button");if(r)r.removeClass("hidden");else{let n=e.createEl("button",{text:"Link",cls:"link-button"});n.onclick=()=>this.createPotentialLink(null,t,e)}new J.Notice(`Potential link deleted: ${t}`)}catch(i){u(this.plugin,`Error in deletePotentialLink: ${i.message}`),new J.Notice(`Error deleting potential link: ${i.message}`),console.error(i)}}async deletePathway(t,e){this.showItemLoading(e),u(this.plugin,`Starting deletePathway for ${t.backlink}`);let{backlink:i,match:s}=t,n=`${this.plugin.settings.pathwaysOutputFolder}/${i}.md`;try{await this.app.vault.adapter.remove(n),u(this.plugin,`Deleted file: ${n}`);let o=this.app.workspace.getActiveViewOfType(J.MarkdownView);if(o){let m=o.editor,S=m.getValue().replace(` [[${i}]]`,"");m.setValue(S),u(this.plugin,`Removed backlink: [[${i}]]`)}let l=e.querySelector(".delete-pathway-button"),p=e.querySelector(".create-pathway-button");l&&l.addClass("hidden"),p&&p.removeClass("hidden"),new J.Notice(`Pathway deleted: ${i}`)}catch(o){u(this.plugin,`Error in deletePathway: ${o.message}`),new J.Notice(`Error deleting pathway: ${o.message}`),console.error(o)}finally{this.hideItemLoading(e)}}};var yt=class extends $.Plugin{async onload(){await this.loadSettings(),this.fixFolderPaths(),this.youtubeProvider=new pt(this),this.tavilyProvider=new $e(this.settings.tavilyApiKey,this),this.addSettingTab(new Qe(this.app,this)),this.registerView(Oe,t=>new qe(t,this)),this.addCommand({id:"process-active-note",name:"Process Active Note",callback:()=>{new dt(this.app,this).open()}}),this.addCommand({id:"process-clipboard",name:"Process Clipboard",callback:()=>{new Be(this.app,this).open()}}),this.addCommand({id:"tavily-search",name:"Tavily Search",callback:()=>{new ut(this.app,this).open()}}),this.addCommand({id:"analyze-pathways",name:"Analyze Pathways",callback:()=>{let t=this.app.workspace.getActiveViewOfType($.MarkdownView);if(t){let e=t.getViewData();new vt(this.app,this,e).open()}else new $.Notice("Please open a markdown file to analyze pathways.")}}),this.createWorkflowCommands(),this.addRibbonIcon("brain","Mesh AI Integration",()=>{this.activateView()}),this.registerEvent(this.app.workspace.on("editor-menu",(t,e)=>{e.getSelection()&&t.addItem(i=>{i.setTitle("Mesh AI: Process Selection").setIcon("brain").onClick(async()=>{let s=e.getSelection();await navigator.clipboard.writeText(s),new Be(this.app,this).open()})})}))}createWorkflowCommands(){this.removeWorkflowCommands(),this.settings.workflows.forEach((t,e)=>{this.addCommand({id:`mesh-ai-workflow-${e+1}-active-note`,name:`Run Workflow: ${t.name} (Active Note)`,callback:()=>this.runWorkflow(t,"active-note")}),this.addCommand({id:`mesh-ai-workflow-${e+1}-clipboard`,name:`Run Workflow: ${t.name} (Clipboard)`,callback:()=>this.runWorkflow(t,"clipboard")}),this.addCommand({id:`mesh-ai-workflow-${e+1}-tavily`,name:`Run Workflow: ${t.name} (Tavily)`,callback:()=>new ht(this.app,this,t).open()})})}removeWorkflowCommands(){}async runWorkflow(t,e){let i=new $.Notice(`Running workflow: ${t.name}...`,0),s;try{let r;t.usePatternStitching?(s=await He(this.app,this,e),r=await de(this,t.provider,t.patterns,s)):(s=await He(this.app,this,e),r=await pe(this,t.provider,t.patterns,s));let n=`Workflow Output ${new Date().toISOString().replace(/:/g,"-")}`;await fe(this,r,n),new $.Notice(`Workflow '${t.name}' processed successfully`)}catch(r){console.error("Error processing workflow:",r),new $.Notice(`Error in workflow '${t.name}': ${r instanceof Error?r.message:String(r)}`)}finally{i.hide()}}async loadParticlesJS(){return new Promise(t=>{typeof window.particlesJS=="function"?(console.log("particlesJS loaded successfully"),t()):(console.error("particlesJS is not available"),t())})}async loadSettings(){this.settings=Object.assign({},$t,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}async activateView(){let{workspace:t}=this.app,e=t.getLeavesOfType(Oe)[0];if(!e){let i=t.getRightLeaf(!1);i?(await i.setViewState({type:Oe,active:!0}),e=i):(e=t.getLeaf("split","vertical"),await e.setViewState({type:Oe,active:!0}))}t.revealLeaf(e)}async loadAllPatterns(){let t=await this.loadCustomPatterns(),e=await this.loadFabricPatterns();return[...new Set([...t,...e])].sort()}async loadCustomPatterns(){let t=this.app.vault.getAbstractFileByPath(this.settings.customPatternsFolder),e=[];if(t instanceof $.TFolder)for(let i of t.children)i instanceof $.TFile&&i.extension==="md"&&e.push(i.basename);return e.sort()}async loadFabricPatterns(){let t=(0,$.normalizePath)(this.settings.fabricPatternsFolder),e=this.app.vault.getAbstractFileByPath(t),i=[];if(e instanceof $.TFolder)for(let s of e.children)s instanceof $.TFile&&s.extension==="md"&&i.push(s.basename);return i.sort()}async downloadPatternsFromGitHub(){var s,r,n;let t="danielmiessler",e="fabric",i=`https://api.github.com/repos/${t}/${e}`;try{let o=(0,$.normalizePath)(this.settings.fabricPatternsFolder);if(!o){new $.Notice("Please set a Fabric patterns folder in Settings before downloading.");return}this.app.vault.getAbstractFileByPath(o)instanceof $.TFolder||await this.app.vault.createFolder(o);let m=(r=(s=(await(0,$.requestUrl)({url:i})).json)==null?void 0:s.default_branch)!=null?r:"main",w=`${i}/git/trees/${m}?recursive=1`,T=(n=(await(0,$.requestUrl)({url:w})).json)==null?void 0:n.tree;if(!Array.isArray(T))throw new Error("Unexpected GitHub API response: repository tree missing.");let k=["system.md","prompt.md","pattern.md","README.md","readme.md"],F=new Set(k.map(L=>L.toLowerCase())),V=["patterns/","data/patterns/"],ie={};for(let L of T){if(L.type!=="blob"||!V.some(Ee=>L.path.startsWith(Ee)))continue;let j=L.path.split("/");if(j.length<3)continue;let z=j[j.length-1],Y=j[j.length-2],Z=z.toLowerCase();if(!F.has(Z))continue;let ue=k.findIndex(Ee=>Ee.toLowerCase()===Z);if(ue===-1)continue;let se=ie[Y];(!se||ue<se.priority)&&(ie[Y]={path:L.path,priority:ue})}let O=Object.entries(ie);if(O.length===0)throw new Error("No pattern files found under /patterns or /data/patterns in the Fabric repository.");let H=0,X=0;for(let[L,j]of O)try{let z=`${L}.md`,Y=`https://raw.githubusercontent.com/${t}/${e}/${m}/${j.path}`,Z=(0,$.normalizePath)(`${this.settings.fabricPatternsFolder}/${z}`),ue=await(0,$.requestUrl)({url:Y}),se=this.app.vault.getAbstractFileByPath(Z);se instanceof $.TFile?(await this.app.vault.modify(se,ue.text),u(this,`Updated existing file: ${z}`)):(await this.app.vault.create(Z,ue.text),u(this,`Created new file: ${z}`)),H++}catch(z){u(this,`Error processing ${j.path}:`,z),z instanceof Error&&u(this,`Error message: ${z.message}`),X++}new $.Notice(`Successfully downloaded/updated ${H} patterns. ${X} failed.`),await this.loadAllPatterns()}catch(o){let l=o instanceof Error?o.message:String(o);u(this,"Error in downloadPatternsFromGitHub:",l),new $.Notice(`Failed to download patterns: ${l}`)}}async clearFabricPatternsFolder(){let t=this.app.vault.getAbstractFileByPath(this.settings.fabricPatternsFolder);if(t instanceof $.TFolder)for(let e of t.children)e instanceof $.TFile&&await this.app.fileManager.trashFile(e);else await this.app.vault.createFolder(this.settings.fabricPatternsFolder)}getProvider(t){switch(t){case"openai":return new Ze(this.settings.openaiApiKey,this);case"google":return new et(this.settings.googleApiKey,this);case"microsoft":return new tt(this.settings.microsoftApiKey,this);case"anthropic":return new it(this.settings.anthropicApiKey,this);case"grocq":return new st(this.settings.grocqApiKey,this);case"ollama":return new at(this.settings.ollamaServerUrl,this);case"openrouter":return new mt(this.settings.openrouterApiKey,this);case"lmstudio":return new ft(this.settings.lmstudioServerUrl,this);default:throw new Error(`Unknown provider: ${t}`)}}getSearchProvider(t){switch(t){case"tavily":return new $e(this.settings.tavilyApiKey,this);case"perplexity":return new gt(this.settings.perplexityApiKey,this);default:throw new Error(`Unsupported search provider: ${t}`)}}reloadMeshView(){this.app.workspace.getLeavesOfType(Oe).forEach(e=>{e.view instanceof qe&&e.view.onOpen()})}fixFolderPaths(){let t=["customPatternsFolder","fabricPatternsFolder","meshOutputFolder"],e=!1;for(let i of t)typeof this.settings[i]=="string"&&this.settings[i].includes("\\")&&(this.settings[i]=this.settings[i].replace(/\\/g,"/"),e=!0);e&&this.saveSettings()}};
/*! Bundled license information:

youtube-transcript/dist/youtube-transcript.esm.js:
  (*! *****************************************************************************
  Copyright (c) Microsoft Corporation.
  
  Permission to use, copy, modify, and/or distribute this software for any
  purpose with or without fee is hereby granted.
  
  THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
  REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
  AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
  INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
  LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
  OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
  PERFORMANCE OF THIS SOFTWARE.
  ***************************************************************************** *)
*/

/* nosourcemap */